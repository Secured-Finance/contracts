{
  "address": "0x2faa06B6981E93594aBF439036e7fA633F46b2d3",
  "abi": [
    {
      "inputs": [],
      "name": "InvalidCircuitBreakerLimitRange",
      "type": "error"
    },
    {
      "inputs": [],
      "name": "InvalidOrderFeeRate",
      "type": "error"
    },
    {
      "inputs": [],
      "name": "OrderBookNotMatured",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "bytes32",
          "name": "ccy",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "previousRate",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "rate",
          "type": "uint256"
        }
      ],
      "name": "CircuitBreakerLimitRangeUpdated",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "bytes32",
          "name": "ccy",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "openingUnitPrice",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "lastLendUnitPrice",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "lastBorrowUnitPrice",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "offsetAmount",
          "type": "uint256"
        }
      ],
      "name": "ItayoseExecuted",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "orderBookId",
          "type": "uint8"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "openingDate",
          "type": "uint256"
        }
      ],
      "name": "OrderBookCreated",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "bytes32",
          "name": "ccy",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "previousRate",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "rate",
          "type": "uint256"
        }
      ],
      "name": "OrderFeeRateUpdated",
      "type": "event"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getBestBorrowUnitPrice",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8[]",
          "name": "_orderBookIds",
          "type": "uint8[]"
        }
      ],
      "name": "getBestBorrowUnitPrices",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "unitPrices",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getBestLendUnitPrice",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8[]",
          "name": "_orderBookIds",
          "type": "uint8[]"
        }
      ],
      "name": "getBestLendUnitPrices",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "unitPrices",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "_count",
          "type": "uint256"
        }
      ],
      "name": "getBlockUnitPriceAverage",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getBlockUnitPriceHistory",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "unitPrices",
          "type": "uint256[]"
        },
        {
          "internalType": "uint48",
          "name": "timestamp",
          "type": "uint48"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "_start",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "_limit",
          "type": "uint256"
        }
      ],
      "name": "getBorrowOrderBook",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "unitPrices",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256[]",
          "name": "amounts",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256[]",
          "name": "quantities",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256",
          "name": "next",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getCircuitBreakerThresholds",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "maxLendUnitPrice",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "minBorrowUnitPrice",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getItayoseEstimation",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "openingUnitPrice",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "lastLendUnitPrice",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "lastBorrowUnitPrice",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "totalOffsetAmount",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getLastOrderTimestamp",
      "outputs": [
        {
          "internalType": "uint48",
          "name": "",
          "type": "uint48"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "_start",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "_limit",
          "type": "uint256"
        }
      ],
      "name": "getLendOrderBook",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "unitPrices",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256[]",
          "name": "amounts",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256[]",
          "name": "quantities",
          "type": "uint256[]"
        },
        {
          "internalType": "uint256",
          "name": "next",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getMarketUnitPrice",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8[]",
          "name": "_orderBookIds",
          "type": "uint8[]"
        }
      ],
      "name": "getMaturities",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "maturities",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "getOrderBookDetail",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "ccy",
          "type": "bytes32"
        },
        {
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "openingDate",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "preOpeningDate",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "isItayosePeriod",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "isMatured",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "isOpened",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "isPreOrderPeriod",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint8",
          "name": "_orderBookId",
          "type": "uint8"
        }
      ],
      "name": "isReady",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
  ],
  "transactionHash": "0xc5fd644a46c9262246dd3ca2d4a34a0c7c64414ddca0ca613fa4927da06007e2",
  "receipt": {
    "to": null,
    "from": "0x4F122d7FCE7971E38801aF5d96fcD4ed83EFD654",
    "contractAddress": "0x2faa06B6981E93594aBF439036e7fA633F46b2d3",
    "transactionIndex": 3,
    "gasUsed": "3323716",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0x56697d23256530ba633579cc2b98ce5c0d23f07a219a6037864cb97907edec47",
    "transactionHash": "0xc5fd644a46c9262246dd3ca2d4a34a0c7c64414ddca0ca613fa4927da06007e2",
    "logs": [],
    "blockNumber": 27785055,
    "cumulativeGasUsed": "3582328",
    "status": 1,
    "byzantium": true
  },
  "args": [],
  "numDeployments": 2,
  "solcInputHash": "884f6674a3716f33c276f68b0a799238",
  "metadata": "{\"compiler\":{\"version\":\"0.8.19+commit.7dd6d404\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"InvalidCircuitBreakerLimitRange\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidOrderFeeRate\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"OrderBookNotMatured\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"bytes32\",\"name\":\"ccy\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"previousRate\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"rate\",\"type\":\"uint256\"}],\"name\":\"CircuitBreakerLimitRangeUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"bytes32\",\"name\":\"ccy\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"openingUnitPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lastLendUnitPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lastBorrowUnitPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"offsetAmount\",\"type\":\"uint256\"}],\"name\":\"ItayoseExecuted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint8\",\"name\":\"orderBookId\",\"type\":\"uint8\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"openingDate\",\"type\":\"uint256\"}],\"name\":\"OrderBookCreated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"bytes32\",\"name\":\"ccy\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"previousRate\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"rate\",\"type\":\"uint256\"}],\"name\":\"OrderFeeRateUpdated\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getBestBorrowUnitPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8[]\",\"name\":\"_orderBookIds\",\"type\":\"uint8[]\"}],\"name\":\"getBestBorrowUnitPrices\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"unitPrices\",\"type\":\"uint256[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getBestLendUnitPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8[]\",\"name\":\"_orderBookIds\",\"type\":\"uint8[]\"}],\"name\":\"getBestLendUnitPrices\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"unitPrices\",\"type\":\"uint256[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"},{\"internalType\":\"uint256\",\"name\":\"_count\",\"type\":\"uint256\"}],\"name\":\"getBlockUnitPriceAverage\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getBlockUnitPriceHistory\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"unitPrices\",\"type\":\"uint256[]\"},{\"internalType\":\"uint48\",\"name\":\"timestamp\",\"type\":\"uint48\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"},{\"internalType\":\"uint256\",\"name\":\"_start\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_limit\",\"type\":\"uint256\"}],\"name\":\"getBorrowOrderBook\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"unitPrices\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256[]\",\"name\":\"amounts\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256[]\",\"name\":\"quantities\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256\",\"name\":\"next\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getCircuitBreakerThresholds\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"maxLendUnitPrice\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"minBorrowUnitPrice\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getItayoseEstimation\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"openingUnitPrice\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"lastLendUnitPrice\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"lastBorrowUnitPrice\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"totalOffsetAmount\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getLastOrderTimestamp\",\"outputs\":[{\"internalType\":\"uint48\",\"name\":\"\",\"type\":\"uint48\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"},{\"internalType\":\"uint256\",\"name\":\"_start\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_limit\",\"type\":\"uint256\"}],\"name\":\"getLendOrderBook\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"unitPrices\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256[]\",\"name\":\"amounts\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256[]\",\"name\":\"quantities\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256\",\"name\":\"next\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getMarketUnitPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8[]\",\"name\":\"_orderBookIds\",\"type\":\"uint8[]\"}],\"name\":\"getMaturities\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"maturities\",\"type\":\"uint256[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"getOrderBookDetail\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"ccy\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"openingDate\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"preOpeningDate\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"isItayosePeriod\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"isMatured\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"isOpened\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"isPreOrderPeriod\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_orderBookId\",\"type\":\"uint8\"}],\"name\":\"isReady\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/protocol/libraries/logics/OrderBookLogic.sol\":\"OrderBookLogic\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[]},\"sources\":{\"contracts/protocol/interfaces/ILendingMarket.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nimport \\\"../types/ProtocolTypes.sol\\\";\\nimport {ItayoseLog} from \\\"../storages/LendingMarketStorage.sol\\\";\\nimport {OrderBookLib, FilledOrder, PartiallyFilledOrder} from \\\"../libraries/OrderBookLib.sol\\\";\\n\\ninterface ILendingMarket {\\n    error NoOrderExists();\\n    error CallerNotMaker();\\n    error MarketNotOpened();\\n    error AlreadyItayosePeriod();\\n    error NotItayosePeriod();\\n    error NotPreOrderPeriod();\\n\\n    function getOrderBookDetail(\\n        uint8 orderBookId\\n    )\\n        external\\n        view\\n        returns (bytes32 ccy, uint256 maturity, uint256 openingDate, uint256 preOpeningDate);\\n\\n    function getCircuitBreakerThresholds(\\n        uint8 orderBookId\\n    )\\n        external\\n        view\\n        returns (uint256 lendCircuitBreakerThreshold, uint256 borrowCircuitBreakerThreshold);\\n\\n    function getBestLendUnitPrice(uint8 orderBookId) external view returns (uint256 unitPrice);\\n\\n    function getBestLendUnitPrices(\\n        uint8[] calldata orderBookIds\\n    ) external view returns (uint256[] memory);\\n\\n    function getBestBorrowUnitPrice(uint8 orderBookId) external view returns (uint256 unitPrice);\\n\\n    function getBestBorrowUnitPrices(\\n        uint8[] calldata orderBookIds\\n    ) external view returns (uint256[] memory);\\n\\n    function getMarketUnitPrice(uint8 orderBookId) external view returns (uint256);\\n\\n    function getLastOrderTimestamp(uint8 orderBookId) external view returns (uint48);\\n\\n    function getBlockUnitPriceHistory(\\n        uint8 orderBookId\\n    ) external view returns (uint256[] memory unitPrices, uint48 timestamp);\\n\\n    function getBlockUnitPriceAverage(\\n        uint8 orderBookId,\\n        uint256 count\\n    ) external view returns (uint256);\\n\\n    function getBorrowOrderBook(\\n        uint8 orderBookId,\\n        uint256 start,\\n        uint256 limit\\n    )\\n        external\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        );\\n\\n    function getLendOrderBook(\\n        uint8 orderBookId,\\n        uint256 start,\\n        uint256 limit\\n    )\\n        external\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        );\\n\\n    function getItayoseEstimation(\\n        uint8 orderBookId\\n    )\\n        external\\n        view\\n        returns (\\n            uint256 openingUnitPrice,\\n            uint256 lastLendUnitPrice,\\n            uint256 lastBorrowUnitPrice,\\n            uint256 totalOffsetAmount\\n        );\\n\\n    function getMaturity(uint8 orderBookId) external view returns (uint256);\\n\\n    function getMaturities(\\n        uint8[] calldata orderBookIds\\n    ) external view returns (uint256[] memory maturities);\\n\\n    function getCurrency() external view returns (bytes32);\\n\\n    function getOrderFeeRate() external view returns (uint256);\\n\\n    function getCircuitBreakerLimitRange() external view returns (uint256);\\n\\n    function getOpeningDate(uint8 orderBookId) external view returns (uint256);\\n\\n    function isReady(uint8 orderBookId) external view returns (bool);\\n\\n    function isMatured(uint8 orderBookId) external view returns (bool);\\n\\n    function isOpened(uint8 orderBookId) external view returns (bool);\\n\\n    function isItayosePeriod(uint8 orderBookId) external view returns (bool);\\n\\n    function isPreOrderPeriod(uint8 orderBookId) external returns (bool);\\n\\n    function getItayoseLog(uint256 maturity) external view returns (ItayoseLog memory);\\n\\n    function getOrder(\\n        uint8 orderBookId,\\n        uint48 orderId\\n    )\\n        external\\n        view\\n        returns (\\n            ProtocolTypes.Side,\\n            uint256 unitPrice,\\n            uint256 maturity,\\n            address maker,\\n            uint256 amount,\\n            uint256 timestamp,\\n            bool isPreOrder\\n        );\\n\\n    function getTotalAmountFromLendOrders(\\n        uint8 orderBookId,\\n        address user\\n    )\\n        external\\n        view\\n        returns (\\n            uint256 activeAmount,\\n            uint256 inactiveAmount,\\n            uint256 inactiveFutureValue,\\n            uint256 maturity\\n        );\\n\\n    function getTotalAmountFromBorrowOrders(\\n        uint8 orderBookId,\\n        address user,\\n        uint256 _minUnitPrice\\n    )\\n        external\\n        view\\n        returns (\\n            uint256 activeAmount,\\n            uint256 inactiveAmount,\\n            uint256 inactiveFutureValue,\\n            uint256 maturity\\n        );\\n\\n    function getLendOrderIds(\\n        uint8 orderBookId,\\n        address user\\n    ) external view returns (uint48[] memory activeOrderIds, uint48[] memory inActiveOrderIds);\\n\\n    function getBorrowOrderIds(\\n        uint8 orderBookId,\\n        address user\\n    ) external view returns (uint48[] memory activeOrderIds, uint48[] memory inActiveOrderIds);\\n\\n    function calculateFilledAmount(\\n        uint8 orderBookId,\\n        ProtocolTypes.Side side,\\n        uint256 amount,\\n        uint256 unitPrice\\n    )\\n        external\\n        view\\n        returns (\\n            uint256 lastUnitPrice,\\n            uint256 filledAmount,\\n            uint256 filledAmountInFV,\\n            uint256 feeInFV,\\n            uint256 placedAmount\\n        );\\n\\n    function createOrderBook(\\n        uint256 maturity,\\n        uint256 openingDate,\\n        uint256 preOpeningDate\\n    ) external returns (uint8 orderBookId);\\n\\n    function executeAutoRoll(\\n        uint8 maturedOrderBookId,\\n        uint8 newNearestOrderBookId,\\n        uint256 autoRollUnitPrice\\n    ) external;\\n\\n    function cancelOrder(uint8 orderBookId, address user, uint48 orderId) external;\\n\\n    function executeOrder(\\n        uint8 orderBookId,\\n        ProtocolTypes.Side side,\\n        address account,\\n        uint256 amount,\\n        uint256 unitPrice\\n    )\\n        external\\n        returns (\\n            FilledOrder memory filledOrder,\\n            PartiallyFilledOrder memory partiallyFilledOrder,\\n            uint256 feeInFV\\n        );\\n\\n    function executePreOrder(\\n        uint8 orderBookId,\\n        ProtocolTypes.Side side,\\n        address user,\\n        uint256 amount,\\n        uint256 unitPrice\\n    ) external;\\n\\n    function unwindPosition(\\n        uint8 orderBookId,\\n        ProtocolTypes.Side side,\\n        address user,\\n        uint256 futureValue\\n    )\\n        external\\n        returns (\\n            FilledOrder memory filledOrder,\\n            PartiallyFilledOrder memory partiallyFilledOrder,\\n            uint256 feeInFV\\n        );\\n\\n    function executeItayoseCall(\\n        uint8 orderBookId\\n    )\\n        external\\n        returns (\\n            uint256 openingUnitPrice,\\n            uint256 totalOffsetAmount,\\n            uint256 openingDate,\\n            PartiallyFilledOrder memory partiallyFilledLendingOrder,\\n            PartiallyFilledOrder memory partiallyFilledBorrowingOrder\\n        );\\n\\n    function cleanUpOrders(\\n        uint8 orderBookId,\\n        address user\\n    )\\n        external\\n        returns (\\n            uint256 activeLendOrderCount,\\n            uint256 activeBorrowOrderCount,\\n            uint256 removedLendOrderFutureValue,\\n            uint256 removedBorrowOrderFutureValue,\\n            uint256 removedLendOrderAmount,\\n            uint256 removedBorrowOrderAmount,\\n            uint256 maturity\\n        );\\n\\n    function updateOrderFeeRate(uint256 orderFeeRate) external;\\n\\n    function updateCircuitBreakerLimitRange(uint256 limitRange) external;\\n\\n    function pause() external;\\n\\n    function unpause() external;\\n}\\n\",\"keccak256\":\"0x432be1b53206d65f1cfa36131ef72d095b6bda8313b906ad792397351c128fba\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/libraries/Constants.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nlibrary Constants {\\n    /// @dev Used for price digits in the basis (10000 -> 1)\\n    uint256 internal constant PRICE_DIGIT = 10000;\\n\\n    /// @dev Used for percentage digits in the basis (10000 -> 100%)\\n    uint256 internal constant PCT_DIGIT = 10000;\\n\\n    /// @dev Used for seconds in year (60 * 60 * 24 * 365)\\n    uint256 internal constant SECONDS_IN_YEAR = 31536000;\\n\\n    /// @dev Used for maximum order count per currency\\n    uint256 internal constant MAXIMUM_ORDER_COUNT = 20;\\n}\\n\",\"keccak256\":\"0x21443c5b15f48894fc2ab2f1ea266a01d59e7808f50c569bf5556f6bb298f5d6\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/libraries/OrderBookLib.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nimport {Constants} from \\\"./Constants.sol\\\";\\nimport {ProtocolTypes} from \\\"../types/ProtocolTypes.sol\\\";\\nimport {OrderStatisticsTreeLib, PartiallyRemovedOrder} from \\\"./OrderStatisticsTreeLib.sol\\\";\\nimport {RoundingUint256} from \\\"./math/RoundingUint256.sol\\\";\\n\\nstruct PlacedOrder {\\n    ProtocolTypes.Side side;\\n    uint256 unitPrice;\\n    uint256 maturity;\\n    uint256 timestamp;\\n}\\n\\nstruct FilledOrder {\\n    uint256 amount;\\n    uint256 unitPrice;\\n    uint256 futureValue;\\n    uint256 ignoredAmount;\\n}\\n\\nstruct PartiallyFilledOrder {\\n    uint48 orderId;\\n    address maker;\\n    uint256 amount;\\n    uint256 futureValue;\\n}\\n\\nlibrary OrderBookLib {\\n    using OrderStatisticsTreeLib for OrderStatisticsTreeLib.Tree;\\n    using RoundingUint256 for uint256;\\n\\n    uint256 public constant PRE_ORDER_BASE_PERIOD = 7 days;\\n    uint256 public constant ITAYOSE_PERIOD = 1 hours;\\n    uint256 public constant CIRCUIT_BREAKER_MINIMUM_LEND_RANGE = 700;\\n    uint256 public constant CIRCUIT_BREAKER_MINIMUM_BORROW_RANGE = 200;\\n\\n    error EmptyOrderBook();\\n    error PastMaturityOrderExists();\\n\\n    struct OrderBook {\\n        uint256 maturity;\\n        uint256 openingDate;\\n        uint256 preOpeningDate;\\n        uint48 lastOrderId;\\n        uint48 lastOrderTimestamp;\\n        bool isReliableBlock;\\n        // Micro slots for block unit price history\\n        uint80 blockUnitPriceHistory;\\n        uint48 lastBlockUnitPriceTimestamp;\\n        uint256 blockTotalAmount;\\n        uint256 blockTotalFutureValue;\\n        mapping(address user => uint48[] orderIds) activeLendOrderIds;\\n        mapping(address user => uint48[] orderIds) activeBorrowOrderIds;\\n        // Maturity when user last executes order\\n        mapping(address user => uint256 maturity) userCurrentMaturities;\\n        // Micro slots for order\\n        mapping(uint48 orderId => uint256 slots) orders;\\n        mapping(uint48 orderId => bool isPreOrder) isPreOrder;\\n        mapping(uint256 maturity => OrderStatisticsTreeLib.Tree orders) lendOrders;\\n        mapping(uint256 maturity => OrderStatisticsTreeLib.Tree orders) borrowOrders;\\n    }\\n\\n    function initialize(\\n        OrderBook storage self,\\n        uint256 _maturity,\\n        uint256 _openingDate,\\n        uint256 _preOpeningDate\\n    ) internal returns (bool isReady) {\\n        self.maturity = _maturity;\\n        self.openingDate = _openingDate;\\n        self.preOpeningDate = _preOpeningDate;\\n\\n        self.blockTotalAmount = 0;\\n        self.blockTotalFutureValue = 0;\\n        self.blockUnitPriceHistory = 0;\\n        self.lastOrderTimestamp = 0;\\n        self.lastBlockUnitPriceTimestamp = 0;\\n        self.isReliableBlock = false;\\n\\n        if (block.timestamp >= (_openingDate - ITAYOSE_PERIOD)) {\\n            isReady = true;\\n        }\\n    }\\n\\n    function isMatured(OrderBook storage self) internal view returns (bool) {\\n        return block.timestamp >= self.maturity;\\n    }\\n\\n    function getBestBorrowUnitPrice(OrderBook storage self) internal view returns (uint256) {\\n        return self.lendOrders[self.maturity].last();\\n    }\\n\\n    function getBestLendUnitPrice(OrderBook storage self) internal view returns (uint256) {\\n        uint256 unitPrice = self.borrowOrders[self.maturity].first();\\n        return unitPrice == 0 ? Constants.PRICE_DIGIT : unitPrice;\\n    }\\n\\n    function hasBorrowOrder(OrderBook storage self, address _user) internal view returns (bool) {\\n        return self.activeBorrowOrderIds[_user].length != 0;\\n    }\\n\\n    function hasLendOrder(OrderBook storage self, address _user) internal view returns (bool) {\\n        return self.activeLendOrderIds[_user].length != 0;\\n    }\\n\\n    function getOrder(\\n        OrderBook storage self,\\n        uint48 _orderId\\n    ) internal view returns (PlacedOrder memory order) {\\n        (\\n            ProtocolTypes.Side side,\\n            uint256 unitPrice,\\n            uint256 maturity,\\n            uint256 timestamp\\n        ) = _unpackOrder(self.orders[_orderId]);\\n        order = PlacedOrder(side, unitPrice, maturity, timestamp);\\n    }\\n\\n    function getBlockUnitPriceHistory(\\n        OrderBook storage self,\\n        bool _isReadOnly\\n    ) internal view returns (uint256[] memory prices, uint48 timestamp) {\\n        prices = _unpackBlockUnitPriceHistory(self.blockUnitPriceHistory);\\n\\n        // NOTE: If an order is in the first block of the order book, the block unit price history is empty.\\n        // In this case, the first history record is calculated from the current block total amount and total future value\\n        // along with the `getMarketUnitPrice` function logic.\\n        if (\\n            (self.lastOrderTimestamp != block.timestamp || prices[0] == 0 || _isReadOnly) &&\\n            self.isReliableBlock\\n        ) {\\n            for (uint256 i = prices.length - 1; i > 0; i--) {\\n                prices[i] = prices[i - 1];\\n            }\\n\\n            prices[0] = (self.blockTotalAmount * Constants.PRICE_DIGIT).div(\\n                self.blockTotalFutureValue\\n            );\\n            timestamp = self.lastOrderTimestamp;\\n        } else {\\n            timestamp = self.lastBlockUnitPriceTimestamp;\\n        }\\n    }\\n\\n    function getMarketUnitPrice(\\n        OrderBook storage self,\\n        bool _isReadOnly\\n    ) internal view returns (uint256 unitPrice) {\\n        unitPrice = _unpackBlockUnitPriceHistory(self.blockUnitPriceHistory)[0];\\n\\n        // NOTE: If an order is in the first block of the order book, the block unit price history is empty.\\n        // In this case, the market unit price is calculated from the current block total amount and total future value\\n        // to avoid unwinding or liquidation the order in the same block using 0 as the market unit price.\\n        if (\\n            (self.lastOrderTimestamp != block.timestamp || unitPrice == 0 || _isReadOnly) &&\\n            self.isReliableBlock\\n        ) {\\n            unitPrice = (self.blockTotalAmount * Constants.PRICE_DIGIT).div(\\n                self.blockTotalFutureValue\\n            );\\n        }\\n    }\\n\\n    function getBlockUnitPriceAverage(\\n        OrderBook storage self,\\n        uint256 maxCount,\\n        bool _isReadOnly\\n    ) internal view returns (uint256 unitPrice) {\\n        uint256[] memory unitPrices = _unpackBlockUnitPriceHistory(self.blockUnitPriceHistory);\\n        uint256 length = unitPrices.length;\\n        uint256 sum;\\n        uint256 count;\\n\\n        if ((self.lastOrderTimestamp != block.timestamp || _isReadOnly) && self.isReliableBlock) {\\n            sum = (self.blockTotalAmount * Constants.PRICE_DIGIT).div(self.blockTotalFutureValue);\\n            count = 1;\\n            maxCount--;\\n        }\\n\\n        for (uint256 i; i < maxCount; i++) {\\n            if (i >= length || unitPrices[i] == 0) {\\n                break;\\n            }\\n\\n            sum += unitPrices[i];\\n            count++;\\n        }\\n\\n        unitPrice = count > 0 ? sum.div(count) : 0;\\n    }\\n\\n    function getLendOrderBook(\\n        OrderBook storage self,\\n        uint256 _start,\\n        uint256 _limit\\n    )\\n        internal\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        )\\n    {\\n        unitPrices = new uint256[](_limit);\\n        amounts = new uint256[](_limit);\\n        quantities = new uint256[](_limit);\\n\\n        uint256 unitPrice;\\n\\n        if (_start == 0) {\\n            unitPrice = self.lendOrders[self.maturity].last();\\n        } else {\\n            (bool exists, uint256 parent) = self.lendOrders[self.maturity].search(_start);\\n\\n            if (exists) {\\n                unitPrice = _start;\\n            } else if (parent < _start) {\\n                unitPrice = parent;\\n            } else {\\n                unitPrice = self.lendOrders[self.maturity].prev(parent);\\n            }\\n        }\\n\\n        unitPrices[0] = unitPrice;\\n        amounts[0] = self.lendOrders[self.maturity].getNodeTotalAmount(unitPrice);\\n        quantities[0] = self.lendOrders[self.maturity].getNodeCount(unitPrice);\\n\\n        for (uint256 i = 1; i < unitPrices.length; i++) {\\n            if (unitPrice == 0) {\\n                break;\\n            }\\n\\n            unitPrice = self.lendOrders[self.maturity].prev(unitPrice);\\n            unitPrices[i] = unitPrice;\\n            amounts[i] = self.lendOrders[self.maturity].getNodeTotalAmount(unitPrice);\\n            quantities[i] = self.lendOrders[self.maturity].getNodeCount(unitPrice);\\n        }\\n\\n        if (unitPrice != 0) {\\n            next = self.lendOrders[self.maturity].prev(unitPrice);\\n        }\\n    }\\n\\n    function getBorrowOrderBook(\\n        OrderBook storage self,\\n        uint256 _start,\\n        uint256 _limit\\n    )\\n        internal\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        )\\n    {\\n        unitPrices = new uint256[](_limit);\\n        amounts = new uint256[](_limit);\\n        quantities = new uint256[](_limit);\\n\\n        uint256 unitPrice;\\n\\n        if (_start == 0) {\\n            unitPrice = self.borrowOrders[self.maturity].first();\\n        } else {\\n            (bool exists, uint256 parent) = self.borrowOrders[self.maturity].search(_start);\\n\\n            if (exists) {\\n                unitPrice = _start;\\n            } else if (parent > _start) {\\n                unitPrice = parent;\\n            } else {\\n                unitPrice = self.borrowOrders[self.maturity].next(parent);\\n            }\\n        }\\n\\n        unitPrices[0] = unitPrice;\\n        amounts[0] = self.borrowOrders[self.maturity].getNodeTotalAmount(unitPrice);\\n        quantities[0] = self.borrowOrders[self.maturity].getNodeCount(unitPrice);\\n\\n        for (uint256 i = 1; i < unitPrices.length; i++) {\\n            if (unitPrice == 0) {\\n                break;\\n            }\\n\\n            unitPrice = self.borrowOrders[self.maturity].next(unitPrice);\\n            unitPrices[i] = unitPrice;\\n            amounts[i] = self.borrowOrders[self.maturity].getNodeTotalAmount(unitPrice);\\n            quantities[i] = self.borrowOrders[self.maturity].getNodeCount(unitPrice);\\n        }\\n\\n        if (unitPrice != 0) {\\n            next = self.borrowOrders[self.maturity].next(unitPrice);\\n        }\\n    }\\n\\n    function getLendOrderIds(\\n        OrderBook storage self,\\n        address _user\\n    ) internal view returns (uint48[] memory activeOrderIds, uint48[] memory inActiveOrderIds) {\\n        uint256 activeOrderCount = 0;\\n        uint256 inActiveOrderCount = 0;\\n        uint256 userMaturity = self.userCurrentMaturities[_user];\\n        bool isPastMaturity = block.timestamp >= userMaturity;\\n\\n        uint48[] memory orderIds = self.activeLendOrderIds[_user];\\n        uint256 orderIdLength = orderIds.length;\\n        activeOrderIds = new uint48[](isPastMaturity ? 0 : orderIdLength);\\n        inActiveOrderIds = new uint48[](orderIdLength);\\n\\n        for (uint256 i; i < orderIdLength; i++) {\\n            uint48 orderId = orderIds[i];\\n            (, uint256 unitPrice, , ) = _unpackOrder(self.orders[orderId]);\\n\\n            if (!self.lendOrders[userMaturity].isActiveOrderId(unitPrice, orderId)) {\\n                unchecked {\\n                    inActiveOrderCount += 1;\\n                }\\n                inActiveOrderIds[i - activeOrderCount] = orderId;\\n                if (!isPastMaturity) {\\n                    assembly {\\n                        mstore(activeOrderIds, sub(mload(activeOrderIds), 1))\\n                    }\\n                }\\n            } else {\\n                unchecked {\\n                    activeOrderCount += 1;\\n                }\\n                if (!isPastMaturity) {\\n                    activeOrderIds[i - inActiveOrderCount] = orderId;\\n                }\\n                assembly {\\n                    mstore(inActiveOrderIds, sub(mload(inActiveOrderIds), 1))\\n                }\\n            }\\n        }\\n    }\\n\\n    function getBorrowOrderIds(\\n        OrderBook storage self,\\n        address _user\\n    ) internal view returns (uint48[] memory activeOrderIds, uint48[] memory inActiveOrderIds) {\\n        uint256 activeOrderCount = 0;\\n        uint256 inActiveOrderCount = 0;\\n        uint256 userMaturity = self.userCurrentMaturities[_user];\\n        bool isPastMaturity = block.timestamp >= userMaturity;\\n\\n        uint48[] memory orderIds = self.activeBorrowOrderIds[_user];\\n        uint256 orderIdLength = orderIds.length;\\n        activeOrderIds = new uint48[](isPastMaturity ? 0 : orderIdLength);\\n        inActiveOrderIds = new uint48[](orderIdLength);\\n\\n        for (uint256 i; i < orderIdLength; i++) {\\n            uint48 orderId = orderIds[i];\\n            (, uint256 unitPrice, , ) = _unpackOrder(self.orders[orderId]);\\n\\n            if (!self.borrowOrders[userMaturity].isActiveOrderId(unitPrice, orderId)) {\\n                unchecked {\\n                    inActiveOrderCount += 1;\\n                }\\n                inActiveOrderIds[i - activeOrderCount] = orderId;\\n                if (!isPastMaturity) {\\n                    assembly {\\n                        mstore(activeOrderIds, sub(mload(activeOrderIds), 1))\\n                    }\\n                }\\n            } else {\\n                unchecked {\\n                    activeOrderCount += 1;\\n                }\\n                if (!isPastMaturity) {\\n                    activeOrderIds[i - inActiveOrderCount] = orderId;\\n                }\\n                assembly {\\n                    mstore(inActiveOrderIds, sub(mload(inActiveOrderIds), 1))\\n                }\\n            }\\n        }\\n    }\\n\\n    function calculateFilledAmount(\\n        OrderBook storage self,\\n        ProtocolTypes.Side _side,\\n        uint256 _amount,\\n        uint256 _unitPrice\\n    )\\n        internal\\n        view\\n        returns (uint256 lastUnitPrice, uint256 filledAmount, uint256 filledAmountInFV)\\n    {\\n        if (_amount == 0) return (0, 0, 0);\\n\\n        if (_side == ProtocolTypes.Side.LEND) {\\n            return\\n                self.borrowOrders[self.maturity].calculateDroppedAmountFromLeft(\\n                    _amount,\\n                    0,\\n                    _unitPrice\\n                );\\n        } else {\\n            return\\n                self.lendOrders[self.maturity].calculateDroppedAmountFromRight(\\n                    _amount,\\n                    0,\\n                    _unitPrice\\n                );\\n        }\\n    }\\n\\n    function updateUserMaturity(OrderBook storage self, address _user) internal {\\n        uint256 userMaturity = self.userCurrentMaturities[_user];\\n        uint256 orderBookMaturity = self.maturity;\\n\\n        if (userMaturity != orderBookMaturity) {\\n            if (\\n                self.activeLendOrderIds[_user].length > 0 ||\\n                self.activeBorrowOrderIds[_user].length > 0\\n            ) {\\n                revert PastMaturityOrderExists();\\n            }\\n\\n            self.userCurrentMaturities[_user] = orderBookMaturity;\\n        }\\n    }\\n\\n    function placeOrder(\\n        OrderBook storage self,\\n        ProtocolTypes.Side _side,\\n        address _user,\\n        uint256 _amount,\\n        uint256 _unitPrice\\n    ) internal returns (uint48 orderId) {\\n        orderId = _nextOrderId(self);\\n        self.orders[orderId] = _packOrder(_side, _unitPrice, self.maturity, block.timestamp);\\n\\n        if (_side == ProtocolTypes.Side.LEND) {\\n            self.lendOrders[self.maturity].insertOrder(_unitPrice, orderId, _user, _amount);\\n            self.activeLendOrderIds[_user].push(orderId);\\n        } else if (_side == ProtocolTypes.Side.BORROW) {\\n            self.borrowOrders[self.maturity].insertOrder(_unitPrice, orderId, _user, _amount);\\n            self.activeBorrowOrderIds[_user].push(orderId);\\n        }\\n    }\\n\\n    function fillOrders(\\n        OrderBook storage self,\\n        ProtocolTypes.Side _side,\\n        uint256 _amount,\\n        uint256 _amountInFV,\\n        uint256 _unitPrice\\n    )\\n        internal\\n        returns (\\n            FilledOrder memory filledOrder,\\n            PartiallyFilledOrder memory partiallyFilledOrder,\\n            uint256 remainingAmount,\\n            bool orderExists\\n        )\\n    {\\n        PartiallyRemovedOrder memory partiallyRemovedOrder;\\n\\n        if (_side == ProtocolTypes.Side.BORROW) {\\n            OrderStatisticsTreeLib.Tree storage orders = self.lendOrders[self.maturity];\\n            (\\n                filledOrder.unitPrice,\\n                filledOrder.amount,\\n                filledOrder.futureValue,\\n                remainingAmount,\\n                partiallyRemovedOrder\\n            ) = orders.dropRight(_amount, _amountInFV, _unitPrice);\\n            orderExists = orders.hasOrders();\\n        } else if (_side == ProtocolTypes.Side.LEND) {\\n            OrderStatisticsTreeLib.Tree storage orders = self.borrowOrders[self.maturity];\\n            (\\n                filledOrder.unitPrice,\\n                filledOrder.amount,\\n                filledOrder.futureValue,\\n                remainingAmount,\\n                partiallyRemovedOrder\\n            ) = orders.dropLeft(_amount, _amountInFV, _unitPrice);\\n            orderExists = orders.hasOrders();\\n        }\\n\\n        partiallyFilledOrder = PartiallyFilledOrder(\\n            partiallyRemovedOrder.orderId,\\n            partiallyRemovedOrder.maker,\\n            partiallyRemovedOrder.amount,\\n            partiallyRemovedOrder.futureValue\\n        );\\n    }\\n\\n    function setInitialBlockUnitPrice(OrderBook storage self, uint256 _unitPrice) internal {\\n        self.blockUnitPriceHistory = uint16(_unitPrice);\\n        self.lastBlockUnitPriceTimestamp = uint48(block.timestamp);\\n        self.lastOrderTimestamp = uint48(block.timestamp);\\n    }\\n\\n    function updateBlockUnitPriceHistory(\\n        OrderBook storage self,\\n        uint256 _filledAmount,\\n        uint256 _filledFutureValue,\\n        uint256 _minimumReliableAmount\\n    ) internal returns (uint256 latestBlockUnitPrice, bool isUpdated) {\\n        latestBlockUnitPrice = _unpackBlockUnitPriceHistory(self.blockUnitPriceHistory)[0];\\n\\n        if (self.lastOrderTimestamp != block.timestamp) {\\n            if (self.isReliableBlock) {\\n                latestBlockUnitPrice = (self.blockTotalAmount * Constants.PRICE_DIGIT).div(\\n                    self.blockTotalFutureValue\\n                );\\n\\n                // Remove the oldest block unit price and add the latest block unit price\\n                self.blockUnitPriceHistory =\\n                    uint16(latestBlockUnitPrice) |\\n                    (self.blockUnitPriceHistory << 16);\\n                self.lastBlockUnitPriceTimestamp = uint48(block.timestamp);\\n                isUpdated = true;\\n            }\\n\\n            self.lastOrderTimestamp = uint48(block.timestamp);\\n            self.blockTotalAmount = _filledAmount;\\n            self.blockTotalFutureValue = _filledFutureValue;\\n            self.isReliableBlock = false;\\n        } else {\\n            self.blockTotalAmount += _filledAmount;\\n            self.blockTotalFutureValue += _filledFutureValue;\\n        }\\n\\n        if (\\n            self.blockTotalAmount >= _minimumReliableAmount ||\\n            (self.blockTotalAmount > 0 && latestBlockUnitPrice == 0)\\n        ) {\\n            self.isReliableBlock = true;\\n        }\\n    }\\n\\n    function removeOrder(\\n        OrderBook storage self,\\n        address _user,\\n        uint48 _orderId\\n    ) internal returns (ProtocolTypes.Side, uint256, uint256) {\\n        (ProtocolTypes.Side side, uint256 unitPrice, , ) = _unpackOrder(self.orders[_orderId]);\\n        uint256 removedAmount;\\n\\n        if (side == ProtocolTypes.Side.LEND) {\\n            removedAmount = self.lendOrders[self.maturity].removeOrder(unitPrice, _orderId);\\n            _removeOrderIdFromOrders(self.activeLendOrderIds[_user], _orderId);\\n        } else if (side == ProtocolTypes.Side.BORROW) {\\n            removedAmount = self.borrowOrders[self.maturity].removeOrder(unitPrice, _orderId);\\n            _removeOrderIdFromOrders(self.activeBorrowOrderIds[_user], _orderId);\\n        }\\n\\n        delete self.orders[_orderId];\\n\\n        return (side, removedAmount, unitPrice);\\n    }\\n\\n    function calculateItayoseResult(\\n        OrderBook storage self\\n    )\\n        internal\\n        view\\n        returns (\\n            uint256 openingUnitPrice,\\n            uint256 lastLendUnitPrice,\\n            uint256 lastBorrowUnitPrice,\\n            uint256 totalOffsetAmount\\n        )\\n    {\\n        uint256 lendUnitPrice = self.lendOrders[self.maturity].last();\\n        uint256 borrowUnitPrice = self.borrowOrders[self.maturity].first();\\n        uint256 lendAmount = self.lendOrders[self.maturity].getNodeTotalAmount(lendUnitPrice);\\n        uint256 borrowAmount = self.borrowOrders[self.maturity].getNodeTotalAmount(borrowUnitPrice);\\n\\n        OrderStatisticsTreeLib.Tree storage borrowOrders = self.borrowOrders[self.maturity];\\n        OrderStatisticsTreeLib.Tree storage lendOrders = self.lendOrders[self.maturity];\\n\\n        // Return 0 if no orders is filled\\n        if (borrowUnitPrice > lendUnitPrice || borrowUnitPrice == 0 || lendUnitPrice == 0) {\\n            return (0, 0, 0, 0);\\n        }\\n\\n        while (borrowUnitPrice <= lendUnitPrice && borrowUnitPrice > 0 && lendUnitPrice > 0) {\\n            lastLendUnitPrice = lendUnitPrice;\\n            lastBorrowUnitPrice = borrowUnitPrice;\\n\\n            if (lendAmount > borrowAmount) {\\n                openingUnitPrice = lendUnitPrice;\\n                totalOffsetAmount += borrowAmount;\\n                lendAmount -= borrowAmount;\\n                borrowUnitPrice = borrowOrders.next(borrowUnitPrice);\\n                borrowAmount = borrowOrders.getNodeTotalAmount(borrowUnitPrice);\\n            } else if (lendAmount < borrowAmount) {\\n                openingUnitPrice = borrowUnitPrice;\\n                totalOffsetAmount += lendAmount;\\n                borrowAmount -= lendAmount;\\n                lendUnitPrice = lendOrders.prev(lendUnitPrice);\\n                lendAmount = lendOrders.getNodeTotalAmount(lendUnitPrice);\\n            } else {\\n                openingUnitPrice = (lendUnitPrice + borrowUnitPrice).div(2);\\n                totalOffsetAmount += lendAmount;\\n                lendUnitPrice = lendOrders.prev(lendUnitPrice);\\n                borrowUnitPrice = borrowOrders.next(borrowUnitPrice);\\n                lendAmount = lendOrders.getNodeTotalAmount(lendUnitPrice);\\n                borrowAmount = borrowOrders.getNodeTotalAmount(borrowUnitPrice);\\n            }\\n        }\\n    }\\n\\n    function getOrderExecutionConditions(\\n        OrderBook storage self,\\n        ProtocolTypes.Side _side,\\n        uint256 _unitPrice,\\n        uint256 _circuitBreakerLimitRange,\\n        bool _isReadOnly\\n    )\\n        internal\\n        view\\n        returns (\\n            bool isFilled,\\n            uint256 executedUnitPrice,\\n            bool ignoreRemainingAmount,\\n            bool orderExists\\n        )\\n    {\\n        bool isLend = _side == ProtocolTypes.Side.LEND;\\n        uint256 cbThresholdUnitPrice;\\n        uint256 bestUnitPrice;\\n\\n        if (isLend) {\\n            bestUnitPrice = self.borrowOrders[self.maturity].first();\\n            cbThresholdUnitPrice = getLendCircuitBreakerThreshold(\\n                self,\\n                _circuitBreakerLimitRange,\\n                _isReadOnly\\n            );\\n        } else {\\n            bestUnitPrice = self.lendOrders[self.maturity].last();\\n            cbThresholdUnitPrice = getBorrowCircuitBreakerThreshold(\\n                self,\\n                _circuitBreakerLimitRange,\\n                _isReadOnly\\n            );\\n        }\\n\\n        orderExists = bestUnitPrice != 0;\\n\\n        if (\\n            _unitPrice == 0 ||\\n            (orderExists &&\\n                cbThresholdUnitPrice != 0 &&\\n                ((isLend && _unitPrice > cbThresholdUnitPrice) ||\\n                    (!isLend && _unitPrice < cbThresholdUnitPrice)))\\n        ) {\\n            executedUnitPrice = cbThresholdUnitPrice;\\n            ignoreRemainingAmount = true;\\n        } else {\\n            executedUnitPrice = _unitPrice;\\n            ignoreRemainingAmount = false;\\n        }\\n\\n        if (orderExists) {\\n            isFilled = isLend\\n                ? bestUnitPrice <= executedUnitPrice\\n                : bestUnitPrice >= executedUnitPrice;\\n        }\\n    }\\n\\n    function getLendCircuitBreakerThreshold(\\n        OrderBook storage self,\\n        uint256 _circuitBreakerLimitRange,\\n        bool _isReadOnly\\n    ) internal view returns (uint256 cbThresholdUnitPrice) {\\n        uint256 blockUnitPriceAverage = getBlockUnitPriceAverage(self, 3, _isReadOnly);\\n        cbThresholdUnitPrice = (blockUnitPriceAverage *\\n            (Constants.PCT_DIGIT + _circuitBreakerLimitRange * 2)).div(Constants.PCT_DIGIT);\\n\\n        if (cbThresholdUnitPrice > Constants.PRICE_DIGIT || blockUnitPriceAverage == 0) {\\n            cbThresholdUnitPrice = Constants.PRICE_DIGIT;\\n        } else if (\\n            cbThresholdUnitPrice < blockUnitPriceAverage + CIRCUIT_BREAKER_MINIMUM_LEND_RANGE\\n        ) {\\n            cbThresholdUnitPrice = blockUnitPriceAverage + CIRCUIT_BREAKER_MINIMUM_LEND_RANGE;\\n        }\\n    }\\n\\n    function getBorrowCircuitBreakerThreshold(\\n        OrderBook storage self,\\n        uint256 _circuitBreakerLimitRange,\\n        bool _isReadOnly\\n    ) internal view returns (uint256 cbThresholdUnitPrice) {\\n        uint256 blockUnitPriceAverage = getBlockUnitPriceAverage(self, 5, _isReadOnly);\\n        cbThresholdUnitPrice = (blockUnitPriceAverage *\\n            (Constants.PCT_DIGIT - _circuitBreakerLimitRange)).div(Constants.PCT_DIGIT);\\n\\n        if (\\n            cbThresholdUnitPrice == 0 ||\\n            blockUnitPriceAverage == 0 ||\\n            blockUnitPriceAverage <= CIRCUIT_BREAKER_MINIMUM_BORROW_RANGE\\n        ) {\\n            cbThresholdUnitPrice = 1;\\n        } else if (\\n            blockUnitPriceAverage < cbThresholdUnitPrice + CIRCUIT_BREAKER_MINIMUM_BORROW_RANGE\\n        ) {\\n            cbThresholdUnitPrice = blockUnitPriceAverage - CIRCUIT_BREAKER_MINIMUM_BORROW_RANGE;\\n        }\\n    }\\n\\n    /**\\n     * @notice Increases and returns id of last order in order book.\\n     * @return The new order id\\n     */\\n    function _nextOrderId(OrderBook storage self) private returns (uint48) {\\n        self.lastOrderId++;\\n        return self.lastOrderId;\\n    }\\n\\n    function _removeOrderIdFromOrders(uint48[] storage orders, uint256 orderId) private {\\n        uint256 lastOrderIndex = orders.length - 1;\\n        for (uint256 i; i <= lastOrderIndex; i++) {\\n            if (orders[i] == orderId) {\\n                if (i != lastOrderIndex) {\\n                    uint48 lastOrderId = orders[lastOrderIndex];\\n                    orders[i] = lastOrderId;\\n                }\\n\\n                orders.pop();\\n                break;\\n            }\\n        }\\n    }\\n\\n    /**\\n     * @notice Packs order parameters into uint256\\n     */\\n    function _packOrder(\\n        ProtocolTypes.Side _side,\\n        uint256 _unitPrice,\\n        uint256 _maturity,\\n        uint256 _timestamp\\n    ) private pure returns (uint256) {\\n        return uint256(_side) | (_unitPrice << 8) | (_maturity << 24) | (_timestamp << 88);\\n    }\\n\\n    /**\\n     * @notice Unpacks order parameters from uint256\\n     */\\n    function _unpackOrder(\\n        uint256 _order\\n    )\\n        private\\n        pure\\n        returns (ProtocolTypes.Side side, uint256 unitPrice, uint256 maturity, uint256 timestamp)\\n    {\\n        side = ProtocolTypes.Side(uint8(_order));\\n        unitPrice = uint16(_order >> 8);\\n        maturity = uint64(_order >> 24);\\n        timestamp = uint64(_order >> 88);\\n    }\\n\\n    function _unpackBlockUnitPriceHistory(\\n        uint80 _blockUnitPriceHistory\\n    ) private pure returns (uint256[] memory prices) {\\n        prices = new uint256[](5);\\n\\n        prices[0] = uint16(_blockUnitPriceHistory);\\n        prices[1] = uint16(_blockUnitPriceHistory >> 16);\\n        prices[2] = uint16(_blockUnitPriceHistory >> 32);\\n        prices[3] = uint16(_blockUnitPriceHistory >> 48);\\n        prices[4] = uint16(_blockUnitPriceHistory >> 64);\\n    }\\n}\\n\",\"keccak256\":\"0x7154c684dd5c19c57505b0123296ed06d885214856c266ff75371689eb542320\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/libraries/OrderStatisticsTreeLib.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\n// libraries\\nimport {Constants} from \\\"../libraries/Constants.sol\\\";\\n// types\\nimport {RoundingUint256} from \\\"./math/RoundingUint256.sol\\\";\\n\\nstruct RemainingOrder {\\n    uint48 orderId;\\n    address maker;\\n    uint256 amount;\\n    uint256 unitPrice;\\n}\\n\\nstruct PartiallyRemovedOrder {\\n    uint48 orderId;\\n    address maker;\\n    uint256 amount;\\n    uint256 futureValue;\\n}\\n\\n/**\\n * @notice OrderStatisticsTreeLib is a Red-Black Tree binary search library\\n * based on the following library that is extended to manage order data.\\n *\\n * https://github.com/rob-Hitchens/OrderStatisticsTree\\n *\\n */\\nlibrary OrderStatisticsTreeLib {\\n    using RoundingUint256 for uint256;\\n    uint256 private constant EMPTY = 0;\\n\\n    struct Node {\\n        uint256 parent;\\n        uint256 left;\\n        uint256 right;\\n        bool red;\\n        uint48 head;\\n        uint48 tail;\\n        uint256 orderCounter;\\n        uint256 orderTotalAmount;\\n        mapping(uint48 orderId => OrderItem) orders;\\n    }\\n\\n    struct Tree {\\n        uint256 root;\\n        mapping(uint256 value => Node) nodes;\\n    }\\n\\n    struct OrderItem {\\n        uint48 orderId;\\n        uint48 next;\\n        uint48 prev;\\n        address maker;\\n        uint256 amount;\\n    }\\n\\n    function first(Tree storage self) internal view returns (uint256 value) {\\n        value = self.root;\\n        if (value == EMPTY) return 0;\\n        while (self.nodes[value].left != EMPTY) {\\n            value = self.nodes[value].left;\\n        }\\n    }\\n\\n    function last(Tree storage self) internal view returns (uint256 value) {\\n        value = self.root;\\n        if (value == EMPTY) return 0;\\n        while (self.nodes[value].right != EMPTY) {\\n            value = self.nodes[value].right;\\n        }\\n    }\\n\\n    function hasOrders(Tree storage self) internal view returns (bool) {\\n        return self.root != EMPTY;\\n    }\\n\\n    function next(Tree storage self, uint256 value) internal view returns (uint256 cursor) {\\n        require(value != EMPTY, \\\"OrderStatisticsTreeLib: Starting value cannot be zero\\\");\\n        if (self.nodes[value].right != EMPTY) {\\n            cursor = treeMinimum(self, self.nodes[value].right);\\n        } else {\\n            cursor = self.nodes[value].parent;\\n            while (cursor != EMPTY && value == self.nodes[cursor].right) {\\n                value = cursor;\\n                cursor = self.nodes[cursor].parent;\\n            }\\n        }\\n    }\\n\\n    function prev(Tree storage self, uint256 value) internal view returns (uint256 cursor) {\\n        require(value != EMPTY, \\\"OrderStatisticsTreeLib: Starting value cannot be zero\\\");\\n        if (self.nodes[value].left != EMPTY) {\\n            cursor = treeMaximum(self, self.nodes[value].left);\\n        } else {\\n            cursor = self.nodes[value].parent;\\n            while (cursor != EMPTY && value == self.nodes[cursor].left) {\\n                value = cursor;\\n                cursor = self.nodes[cursor].parent;\\n            }\\n        }\\n    }\\n\\n    function search(\\n        Tree storage self,\\n        uint256 value\\n    ) internal view returns (bool valueExists, uint256 parent) {\\n        uint256 cursor = self.root;\\n\\n        while (cursor != EMPTY) {\\n            if (value < cursor) {\\n                parent = cursor;\\n                cursor = self.nodes[cursor].left;\\n            } else if (value > cursor) {\\n                parent = cursor;\\n                cursor = self.nodes[cursor].right;\\n            }\\n\\n            if (value == cursor) {\\n                break;\\n            }\\n        }\\n\\n        valueExists = cursor != EMPTY;\\n    }\\n\\n    function exists(Tree storage self, uint256 value) internal view returns (bool) {\\n        if (value == self.root) return true;\\n\\n        uint256 cursor = value;\\n        while (self.nodes[cursor].parent != EMPTY) {\\n            uint256 parent = self.nodes[cursor].parent;\\n            Node storage gn = self.nodes[parent];\\n            if (gn.left != cursor && gn.right != cursor) {\\n                return false;\\n            }\\n            if (parent == self.root) {\\n                return true;\\n            }\\n            cursor = parent;\\n        }\\n        return false;\\n    }\\n\\n    function isActiveOrderId(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal view returns (bool) {\\n        return orderIdExists(self, value, orderId) && exists(self, value);\\n    }\\n\\n    function getNode(\\n        Tree storage self,\\n        uint256 value\\n    ) internal view returns (uint256, uint256, uint256, bool, uint256, uint256, uint256, uint256) {\\n        require(exists(self, value), \\\"OrderStatisticsTreeLib: Value does not exist\\\");\\n        Node storage gn = self.nodes[value];\\n        return (\\n            gn.parent,\\n            gn.left,\\n            gn.right,\\n            gn.red,\\n            gn.head,\\n            gn.tail,\\n            gn.orderCounter,\\n            gn.orderTotalAmount\\n        );\\n    }\\n\\n    function getNodeCount(Tree storage self, uint256 value) internal view returns (uint256) {\\n        Node storage gn = self.nodes[value];\\n        return gn.orderCounter;\\n    }\\n\\n    function getNodeTotalAmount(\\n        Tree storage self,\\n        uint256 value\\n    ) internal view returns (uint256 totalAmount) {\\n        return self.nodes[value].orderTotalAmount;\\n    }\\n\\n    function getNodeOrderIds(\\n        Tree storage self,\\n        uint256 value\\n    ) internal view returns (uint48[] memory orderIds) {\\n        Node storage gn = self.nodes[value];\\n        OrderItem memory order = gn.orders[gn.head];\\n        orderIds = new uint48[](gn.orderCounter);\\n\\n        for (uint256 i; i < gn.orderCounter; i++) {\\n            orderIds[i] = order.orderId;\\n            order = gn.orders[order.next];\\n        }\\n    }\\n\\n    function count(Tree storage self) internal view returns (uint256) {\\n        return getNodeCount(self, self.root);\\n    }\\n\\n    function insert(Tree storage self, uint256 value) internal {\\n        require(value != EMPTY, \\\"OrderStatisticsTreeLib: Value to insert cannot be zero\\\");\\n        uint256 cursor;\\n        uint256 probe = self.root;\\n        while (probe != EMPTY) {\\n            cursor = probe;\\n            if (value < probe) {\\n                probe = self.nodes[probe].left;\\n            } else if (value > probe) {\\n                probe = self.nodes[probe].right;\\n            } else if (value == probe) {\\n                return;\\n            }\\n        }\\n\\n        Node storage nValue = self.nodes[value];\\n        // Update order info as a new one if there is already an old node\\n        if (self.root == EMPTY || nValue.orderCounter != 0) {\\n            nValue.orderCounter = 0;\\n            nValue.orderTotalAmount = 0;\\n            _setHead(self, value, 0);\\n            _setTail(self, value, 0);\\n        }\\n        nValue.parent = cursor;\\n        nValue.left = EMPTY;\\n        nValue.right = EMPTY;\\n        nValue.red = true;\\n\\n        if (cursor == EMPTY) {\\n            self.root = value;\\n        } else if (value < cursor) {\\n            self.nodes[cursor].left = value;\\n        } else {\\n            self.nodes[cursor].right = value;\\n        }\\n        insertFixup(self, value);\\n    }\\n\\n    function remove(Tree storage self, uint256 value) internal {\\n        require(value != EMPTY, \\\"OrderStatisticsTreeLib: Value to remove cannot be zero\\\");\\n        Node storage nValue = self.nodes[value];\\n        uint256 probe;\\n        uint256 cursor;\\n        if (nValue.orderCounter == 0) {\\n            if (self.nodes[value].left == EMPTY || self.nodes[value].right == EMPTY) {\\n                cursor = value;\\n            } else {\\n                cursor = self.nodes[value].right;\\n                while (self.nodes[cursor].left != EMPTY) {\\n                    cursor = self.nodes[cursor].left;\\n                }\\n            }\\n            if (self.nodes[cursor].left != EMPTY) {\\n                probe = self.nodes[cursor].left;\\n            } else {\\n                probe = self.nodes[cursor].right;\\n            }\\n            uint256 cursorParent = self.nodes[cursor].parent;\\n            self.nodes[probe].parent = cursorParent;\\n            if (cursorParent != EMPTY) {\\n                if (cursor == self.nodes[cursorParent].left) {\\n                    self.nodes[cursorParent].left = probe;\\n                } else {\\n                    self.nodes[cursorParent].right = probe;\\n                }\\n            } else {\\n                self.root = probe;\\n            }\\n            bool doFixup = !self.nodes[cursor].red;\\n            if (cursor != value) {\\n                replaceParent(self, cursor, value);\\n                self.nodes[cursor].left = self.nodes[value].left;\\n                self.nodes[self.nodes[cursor].left].parent = cursor;\\n                self.nodes[cursor].right = self.nodes[value].right;\\n                self.nodes[self.nodes[cursor].right].parent = cursor;\\n                self.nodes[cursor].red = self.nodes[value].red;\\n                (cursor, value) = (value, cursor);\\n            }\\n            if (doFixup) {\\n                removeFixup(self, probe);\\n            }\\n            delete self.nodes[cursor];\\n        }\\n    }\\n\\n    function treeMinimum(Tree storage self, uint256 value) private view returns (uint256) {\\n        while (self.nodes[value].left != EMPTY) {\\n            value = self.nodes[value].left;\\n        }\\n        return value;\\n    }\\n\\n    function treeMaximum(Tree storage self, uint256 value) private view returns (uint256) {\\n        while (self.nodes[value].right != EMPTY) {\\n            value = self.nodes[value].right;\\n        }\\n        return value;\\n    }\\n\\n    function rotateLeft(Tree storage self, uint256 value) private {\\n        uint256 cursor = self.nodes[value].right;\\n        uint256 parent = self.nodes[value].parent;\\n        uint256 cursorLeft = self.nodes[cursor].left;\\n        self.nodes[value].right = cursorLeft;\\n        if (cursorLeft != EMPTY) {\\n            self.nodes[cursorLeft].parent = value;\\n        }\\n        self.nodes[cursor].parent = parent;\\n        if (parent == EMPTY) {\\n            self.root = cursor;\\n        } else if (value == self.nodes[parent].left) {\\n            self.nodes[parent].left = cursor;\\n        } else {\\n            self.nodes[parent].right = cursor;\\n        }\\n        self.nodes[cursor].left = value;\\n        self.nodes[value].parent = cursor;\\n    }\\n\\n    function rotateRight(Tree storage self, uint256 value) private {\\n        uint256 cursor = self.nodes[value].left;\\n        uint256 parent = self.nodes[value].parent;\\n        uint256 cursorRight = self.nodes[cursor].right;\\n        self.nodes[value].left = cursorRight;\\n        if (cursorRight != EMPTY) {\\n            self.nodes[cursorRight].parent = value;\\n        }\\n        self.nodes[cursor].parent = parent;\\n        if (parent == EMPTY) {\\n            self.root = cursor;\\n        } else if (value == self.nodes[parent].right) {\\n            self.nodes[parent].right = cursor;\\n        } else {\\n            self.nodes[parent].left = cursor;\\n        }\\n        self.nodes[cursor].right = value;\\n        self.nodes[value].parent = cursor;\\n    }\\n\\n    function insertFixup(Tree storage self, uint256 value) private {\\n        uint256 cursor;\\n        while (value != self.root && self.nodes[self.nodes[value].parent].red) {\\n            uint256 valueParent = self.nodes[value].parent;\\n            if (valueParent == self.nodes[self.nodes[valueParent].parent].left) {\\n                cursor = self.nodes[self.nodes[valueParent].parent].right;\\n                if (self.nodes[cursor].red) {\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[cursor].red = false;\\n                    self.nodes[self.nodes[valueParent].parent].red = true;\\n                    value = self.nodes[valueParent].parent;\\n                } else {\\n                    if (value == self.nodes[valueParent].right) {\\n                        value = valueParent;\\n                        rotateLeft(self, value);\\n                    }\\n                    valueParent = self.nodes[value].parent;\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[self.nodes[valueParent].parent].red = true;\\n                    rotateRight(self, self.nodes[valueParent].parent);\\n                }\\n            } else {\\n                cursor = self.nodes[self.nodes[valueParent].parent].left;\\n                if (self.nodes[cursor].red) {\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[cursor].red = false;\\n                    self.nodes[self.nodes[valueParent].parent].red = true;\\n                    value = self.nodes[valueParent].parent;\\n                } else {\\n                    if (value == self.nodes[valueParent].left) {\\n                        value = valueParent;\\n                        rotateRight(self, value);\\n                    }\\n                    valueParent = self.nodes[value].parent;\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[self.nodes[valueParent].parent].red = true;\\n                    rotateLeft(self, self.nodes[valueParent].parent);\\n                }\\n            }\\n        }\\n        self.nodes[self.root].red = false;\\n    }\\n\\n    function replaceParent(Tree storage self, uint256 a, uint256 b) private {\\n        uint256 bParent = self.nodes[b].parent;\\n        self.nodes[a].parent = bParent;\\n        if (bParent == EMPTY) {\\n            self.root = a;\\n        } else {\\n            if (b == self.nodes[bParent].left) {\\n                self.nodes[bParent].left = a;\\n            } else {\\n                self.nodes[bParent].right = a;\\n            }\\n        }\\n    }\\n\\n    function removeFixup(Tree storage self, uint256 value) private {\\n        uint256 cursor;\\n        while (value != self.root && !self.nodes[value].red) {\\n            uint256 valueParent = self.nodes[value].parent;\\n            if (value == self.nodes[valueParent].left) {\\n                cursor = self.nodes[valueParent].right;\\n                if (self.nodes[cursor].red) {\\n                    self.nodes[cursor].red = false;\\n                    self.nodes[valueParent].red = true;\\n                    rotateLeft(self, valueParent);\\n                    cursor = self.nodes[valueParent].right;\\n                }\\n                if (\\n                    !self.nodes[self.nodes[cursor].left].red &&\\n                    !self.nodes[self.nodes[cursor].right].red\\n                ) {\\n                    self.nodes[cursor].red = true;\\n                    value = valueParent;\\n                } else {\\n                    if (!self.nodes[self.nodes[cursor].right].red) {\\n                        self.nodes[self.nodes[cursor].left].red = false;\\n                        self.nodes[cursor].red = true;\\n                        rotateRight(self, cursor);\\n                        cursor = self.nodes[valueParent].right;\\n                    }\\n                    self.nodes[cursor].red = self.nodes[valueParent].red;\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[self.nodes[cursor].right].red = false;\\n                    rotateLeft(self, valueParent);\\n                    value = self.root;\\n                }\\n            } else {\\n                cursor = self.nodes[valueParent].left;\\n                if (self.nodes[cursor].red) {\\n                    self.nodes[cursor].red = false;\\n                    self.nodes[valueParent].red = true;\\n                    rotateRight(self, valueParent);\\n                    cursor = self.nodes[valueParent].left;\\n                }\\n                if (\\n                    !self.nodes[self.nodes[cursor].right].red &&\\n                    !self.nodes[self.nodes[cursor].left].red\\n                ) {\\n                    self.nodes[cursor].red = true;\\n                    value = valueParent;\\n                } else {\\n                    if (!self.nodes[self.nodes[cursor].left].red) {\\n                        self.nodes[self.nodes[cursor].right].red = false;\\n                        self.nodes[cursor].red = true;\\n                        rotateLeft(self, cursor);\\n                        cursor = self.nodes[valueParent].left;\\n                    }\\n                    self.nodes[cursor].red = self.nodes[valueParent].red;\\n                    self.nodes[valueParent].red = false;\\n                    self.nodes[self.nodes[cursor].left].red = false;\\n                    rotateRight(self, valueParent);\\n                    value = self.root;\\n                }\\n            }\\n        }\\n        self.nodes[value].red = false;\\n    }\\n\\n    function calculateDroppedAmountFromLeft(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue\\n    )\\n        internal\\n        view\\n        returns (uint256 droppedValue, uint256 droppedAmount, uint256 droppedAmountInFV)\\n    {\\n        (droppedValue, , , droppedAmount, droppedAmountInFV, , ) = _calculateDroppedAmountFromLeft(\\n            self,\\n            amount,\\n            amountInFV,\\n            limitValue,\\n            first(self)\\n        );\\n    }\\n\\n    function calculateDroppedAmountFromRight(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue\\n    )\\n        internal\\n        view\\n        returns (uint256 droppedValue, uint256 droppedAmount, uint256 droppedAmountInFV)\\n    {\\n        (droppedValue, , , droppedAmount, droppedAmountInFV, , ) = _calculateDroppedAmountFromRight(\\n            self,\\n            amount,\\n            amountInFV,\\n            limitValue,\\n            last(self)\\n        );\\n    }\\n\\n    function dropLeft(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue\\n    )\\n        internal\\n        returns (\\n            uint256 droppedValue,\\n            uint256 droppedAmount,\\n            uint256 droppedAmountInFV,\\n            uint256 remainingAmount,\\n            PartiallyRemovedOrder memory partiallyRemovedOrder\\n        )\\n    {\\n        uint256 cursor = first(self);\\n        uint256 cursorNodeAmount;\\n        uint256 exceededAmount;\\n        uint256 exceededAmountInFV;\\n\\n        require(cursor <= limitValue || limitValue == 0, \\\"Insufficient limit value\\\");\\n\\n        (\\n            droppedValue,\\n            cursor,\\n            cursorNodeAmount,\\n            droppedAmount,\\n            droppedAmountInFV,\\n            exceededAmount,\\n            exceededAmountInFV\\n        ) = _calculateDroppedAmountFromLeft(self, amount, amountInFV, limitValue, cursor);\\n\\n        uint256 totalNodeAmount = droppedAmount + exceededAmount;\\n\\n        if (totalNodeAmount > 0) {\\n            if (exceededAmount > 0) {\\n                cursor = droppedValue;\\n                // Update order ids in the node.\\n                partiallyRemovedOrder = removeOrders(\\n                    self,\\n                    cursor,\\n                    cursorNodeAmount - exceededAmount\\n                );\\n            } else if (exceededAmountInFV > 0) {\\n                cursor = droppedValue;\\n                // Update order ids in the node.\\n                partiallyRemovedOrder = removeOrders(\\n                    self,\\n                    cursor,\\n                    cursorNodeAmount - _calculatePresentValue(cursor, exceededAmountInFV)\\n                );\\n            }\\n\\n            self.nodes[cursor].left = 0;\\n\\n            uint256 parent = self.nodes[cursor].parent;\\n\\n            if (cursor != EMPTY) {\\n                while (parent != EMPTY) {\\n                    if (parent > cursor) {\\n                        // Relink the nodes\\n                        if (self.nodes[cursor].parent != parent) {\\n                            self.nodes[cursor].parent = parent;\\n                            self.nodes[parent].left = cursor;\\n                        }\\n\\n                        cursor = parent;\\n                    }\\n\\n                    parent = self.nodes[parent].parent;\\n                }\\n            }\\n        }\\n\\n        if (amount > totalNodeAmount) {\\n            remainingAmount = amount - totalNodeAmount;\\n        }\\n\\n        uint256 lastNode = last(self);\\n\\n        if (lastNode == droppedValue && self.nodes[lastNode].orderTotalAmount == 0) {\\n            // The case that all node is dropped.\\n            self.root = EMPTY;\\n        } else if (\\n            droppedValue > self.root ||\\n            (droppedValue == self.root && droppedAmount == totalNodeAmount)\\n        ) {\\n            // The case that the root node is dropped\\n            self.root = cursor;\\n            self.nodes[cursor].parent = 0;\\n        }\\n\\n        rotateTreeToLeft(self);\\n    }\\n\\n    function dropRight(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue\\n    )\\n        internal\\n        returns (\\n            uint256 droppedValue,\\n            uint256 droppedAmount,\\n            uint256 droppedAmountInFV,\\n            uint256 remainingAmount,\\n            PartiallyRemovedOrder memory partiallyRemovedOrder\\n        )\\n    {\\n        uint256 cursor = last(self);\\n        uint256 cursorNodeAmount;\\n        uint256 exceededAmount;\\n        uint256 exceededAmountInFV;\\n\\n        require(cursor >= limitValue || limitValue == 0, \\\"Insufficient limit value\\\");\\n\\n        (\\n            droppedValue,\\n            cursor,\\n            cursorNodeAmount,\\n            droppedAmount,\\n            droppedAmountInFV,\\n            exceededAmount,\\n            exceededAmountInFV\\n        ) = _calculateDroppedAmountFromRight(self, amount, amountInFV, limitValue, cursor);\\n\\n        uint256 totalNodeAmount = droppedAmount + exceededAmount;\\n\\n        if (totalNodeAmount > 0) {\\n            if (exceededAmount > 0) {\\n                cursor = droppedValue;\\n                // Update order ids in the node.\\n                partiallyRemovedOrder = removeOrders(\\n                    self,\\n                    cursor,\\n                    cursorNodeAmount - exceededAmount\\n                );\\n            } else if (exceededAmountInFV > 0) {\\n                cursor = droppedValue;\\n                // Update order ids in the node.\\n                partiallyRemovedOrder = removeOrders(\\n                    self,\\n                    cursor,\\n                    cursorNodeAmount - _calculatePresentValue(cursor, exceededAmountInFV)\\n                );\\n            }\\n\\n            self.nodes[cursor].right = 0;\\n\\n            uint256 parent = self.nodes[cursor].parent;\\n\\n            if (cursor != EMPTY) {\\n                while (parent != EMPTY) {\\n                    if (parent < cursor) {\\n                        // Relink the nodes\\n                        if (self.nodes[cursor].parent != parent) {\\n                            self.nodes[cursor].parent = parent;\\n                            self.nodes[parent].right = cursor;\\n                        }\\n\\n                        cursor = parent;\\n                    }\\n\\n                    parent = self.nodes[parent].parent;\\n                }\\n            }\\n        }\\n\\n        if (amount > totalNodeAmount) {\\n            remainingAmount = amount - totalNodeAmount;\\n        }\\n\\n        uint256 firstNode = first(self);\\n\\n        if (firstNode == droppedValue && self.nodes[firstNode].orderTotalAmount == 0) {\\n            // The case that all node is dropped.\\n            self.root = EMPTY;\\n        } else if (\\n            droppedValue < self.root ||\\n            (droppedValue == self.root && droppedAmount == totalNodeAmount)\\n        ) {\\n            // The case that the root node is dropped\\n            self.root = cursor;\\n            self.nodes[cursor].parent = 0;\\n        }\\n\\n        rotateTreeToRight(self);\\n    }\\n\\n    function rotateTreeToLeft(Tree storage self) internal {\\n        if (self.nodes[self.root].left == 0 && self.nodes[self.root].right != 0) {\\n            if (self.nodes[self.nodes[self.root].right].left != 0) {\\n                rotateRight(self, self.nodes[self.root].right);\\n            }\\n            rotateLeft(self, self.root);\\n        }\\n\\n        if (self.nodes[self.root].red) {\\n            self.nodes[self.root].red = false;\\n        }\\n    }\\n\\n    function rotateTreeToRight(Tree storage self) internal {\\n        if (self.nodes[self.root].right == 0 && self.nodes[self.root].left != 0) {\\n            if (self.nodes[self.nodes[self.root].left].right != 0) {\\n                rotateLeft(self, self.nodes[self.root].left);\\n            }\\n            rotateRight(self, self.root);\\n        }\\n\\n        if (self.nodes[self.root].red) {\\n            self.nodes[self.root].red = false;\\n        }\\n    }\\n\\n    function getFutureValue(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal view returns (uint256) {\\n        return _calculateFutureValue(value, self.nodes[value].orders[orderId].amount);\\n    }\\n\\n    // Double linked list functions\\n    /**\\n     * @dev Retrieves the Object denoted by `_id`.\\n     */\\n    function getOrderById(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal view returns (address maker, uint256 amount) {\\n        Node storage gn = self.nodes[value];\\n        OrderItem memory order = gn.orders[orderId];\\n\\n        maker = order.maker;\\n        amount = order.amount;\\n    }\\n\\n    /**\\n     * @dev Return boolean if value, amount and orderId exist in doubly linked list\\n     */\\n    function orderIdExists(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal view returns (bool) {\\n        uint48 cursor = orderId;\\n        Node storage gn = self.nodes[value];\\n        OrderItem memory order = gn.orders[cursor];\\n\\n        if (order.orderId != cursor) {\\n            return false;\\n        }\\n\\n        while (order.prev != EMPTY) {\\n            cursor = order.prev;\\n            order = gn.orders[cursor];\\n        }\\n\\n        return cursor == gn.head;\\n    }\\n\\n    function insertOrder(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId,\\n        address user,\\n        uint256 amount\\n    ) internal {\\n        require(amount > 0, \\\"Insufficient amount\\\");\\n        require(value <= Constants.PRICE_DIGIT, \\\"Value too high\\\");\\n        insert(self, value);\\n\\n        addTail(self, value, orderId, user, amount);\\n    }\\n\\n    function removeOrder(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal returns (uint256 amount) {\\n        amount = _removeOrder(self, value, orderId);\\n        remove(self, value);\\n    }\\n\\n    function removeOrders(\\n        Tree storage self,\\n        uint256 value,\\n        uint256 _amount\\n    ) internal returns (PartiallyRemovedOrder memory partiallyRemovedOrder) {\\n        Node storage gn = self.nodes[value];\\n\\n        require(\\n            gn.orderTotalAmount >= _amount,\\n            \\\"OrderStatisticsTreeLib: Amount to remove is insufficient\\\"\\n        );\\n\\n        uint256 remainingAmount = _amount;\\n        OrderItem memory currentOrder = gn.orders[gn.head];\\n        uint48 orderId = gn.head;\\n\\n        while (orderId != 0 && remainingAmount != 0) {\\n            currentOrder = gn.orders[orderId];\\n\\n            if (currentOrder.amount <= remainingAmount) {\\n                remainingAmount -= currentOrder.amount;\\n                orderId = currentOrder.next;\\n            } else {\\n                partiallyRemovedOrder = PartiallyRemovedOrder(\\n                    currentOrder.orderId,\\n                    currentOrder.maker,\\n                    remainingAmount,\\n                    _calculateFutureValue(value, remainingAmount)\\n                );\\n                currentOrder = gn.orders[currentOrder.prev];\\n                break;\\n            }\\n        }\\n\\n        if (currentOrder.orderId != 0) {\\n            _removeOrders(self, value, currentOrder.orderId);\\n        }\\n\\n        if (partiallyRemovedOrder.amount > 0) {\\n            self.nodes[value].orders[partiallyRemovedOrder.orderId].amount -= partiallyRemovedOrder\\n                .amount;\\n            self.nodes[value].orderTotalAmount -= partiallyRemovedOrder.amount;\\n        }\\n    }\\n\\n    /**\\n     * @dev Insert a new OrderItem as the new Head with `_amount` in the amount field, and orderId.\\n     */\\n    function addHead(\\n        Tree storage self,\\n        uint256 _value,\\n        uint48 _orderId,\\n        address _user,\\n        uint256 _amount\\n    ) internal {\\n        Node storage gn = self.nodes[_value];\\n        uint48 orderId = _createOrder(self, _value, _orderId, _user, _amount);\\n        _link(self, _value, orderId, gn.head);\\n        _setHead(self, _value, orderId);\\n        if (gn.tail == 0) _setTail(self, _value, orderId);\\n    }\\n\\n    /**\\n     * @dev Insert a new OrderItem as the new Tail with `_amount` in the amount field, and orderId.\\n     */\\n    function addTail(\\n        Tree storage self,\\n        uint256 _value,\\n        uint48 _orderId,\\n        address _user,\\n        uint256 _amount\\n    ) internal {\\n        Node storage gn = self.nodes[_value];\\n\\n        if (gn.head == 0) {\\n            addHead(self, _value, _orderId, _user, _amount);\\n        } else {\\n            uint48 orderId = _createOrder(self, _value, _orderId, _user, _amount);\\n            _link(self, _value, gn.tail, orderId);\\n            _setTail(self, _value, orderId);\\n        }\\n    }\\n\\n    function _calculateDroppedAmountFromLeft(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue,\\n        uint256 firstValue\\n    )\\n        private\\n        view\\n        returns (\\n            uint256 droppedValue,\\n            uint256 cursor,\\n            uint256 cursorNodeAmount,\\n            uint256 droppedAmount,\\n            uint256 droppedAmountInFV,\\n            uint256 exceededAmount,\\n            uint256 exceededAmountInFV\\n        )\\n    {\\n        cursor = firstValue;\\n\\n        while (\\n            (droppedAmount < amount || amount == EMPTY) &&\\n            (droppedAmountInFV < amountInFV || amountInFV == EMPTY) &&\\n            cursor != EMPTY &&\\n            (cursor <= limitValue || limitValue == EMPTY)\\n        ) {\\n            cursorNodeAmount = self.nodes[cursor].orderTotalAmount;\\n            droppedValue = cursor;\\n\\n            droppedAmountInFV += _calculateFutureValue(cursor, cursorNodeAmount);\\n            droppedAmount += cursorNodeAmount;\\n\\n            if (droppedAmount > amount && amount != EMPTY) {\\n                exceededAmount = droppedAmount - amount;\\n                exceededAmountInFV = _calculateFutureValue(cursor, exceededAmount);\\n            } else if (droppedAmountInFV > amountInFV && amountInFV != EMPTY) {\\n                exceededAmountInFV = droppedAmountInFV - amountInFV;\\n                exceededAmount = _calculatePresentValue(cursor, exceededAmountInFV);\\n            }\\n\\n            cursor = next(self, cursor);\\n        }\\n\\n        if (exceededAmount > 0) {\\n            droppedAmount -= exceededAmount;\\n        }\\n        if (exceededAmountInFV > 0) {\\n            droppedAmountInFV -= exceededAmountInFV;\\n        }\\n    }\\n\\n    function _calculateDroppedAmountFromRight(\\n        Tree storage self,\\n        uint256 amount,\\n        uint256 amountInFV,\\n        uint256 limitValue,\\n        uint256 lastValue\\n    )\\n        private\\n        view\\n        returns (\\n            uint256 droppedValue,\\n            uint256 cursor,\\n            uint256 cursorNodeAmount,\\n            uint256 droppedAmount,\\n            uint256 droppedAmountInFV,\\n            uint256 exceededAmount,\\n            uint256 exceededAmountInFV\\n        )\\n    {\\n        cursor = lastValue;\\n\\n        while (\\n            (droppedAmount < amount || amount == EMPTY) &&\\n            (droppedAmountInFV < amountInFV || amountInFV == EMPTY) &&\\n            cursor != EMPTY &&\\n            (cursor >= limitValue || limitValue == EMPTY)\\n        ) {\\n            cursorNodeAmount = self.nodes[cursor].orderTotalAmount;\\n            droppedValue = cursor;\\n\\n            droppedAmountInFV += _calculateFutureValue(cursor, cursorNodeAmount);\\n            droppedAmount += cursorNodeAmount;\\n\\n            if (droppedAmount > amount && amount != EMPTY) {\\n                exceededAmount = droppedAmount - amount;\\n                exceededAmountInFV = _calculateFutureValue(cursor, exceededAmount);\\n            } else if (droppedAmountInFV > amountInFV && amountInFV != EMPTY) {\\n                exceededAmountInFV = droppedAmountInFV - amountInFV;\\n                exceededAmount = _calculatePresentValue(cursor, exceededAmountInFV);\\n            }\\n\\n            cursor = prev(self, cursor);\\n        }\\n\\n        if (exceededAmount > 0) {\\n            droppedAmount -= exceededAmount;\\n        }\\n        if (exceededAmountInFV > 0) {\\n            droppedAmountInFV -= exceededAmountInFV;\\n        }\\n    }\\n\\n    /**\\n     * @dev Internal function to create an unlinked Order.\\n     */\\n    function _createOrder(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId,\\n        address user,\\n        uint256 amount\\n    ) internal returns (uint48) {\\n        Node storage gn = self.nodes[value];\\n        require(\\n            gn.orders[orderId].maker == address(0),\\n            \\\"OrderStatisticsTreeLib: Order id already exists\\\"\\n        );\\n\\n        gn.orderCounter += 1;\\n        gn.orderTotalAmount += amount;\\n        OrderItem memory order = OrderItem(orderId, 0, 0, user, amount);\\n        gn.orders[orderId] = order;\\n        return order.orderId;\\n    }\\n\\n    /**\\n     * @dev Remove the OrderItem denoted by `_id` from the list.\\n     */\\n    function _removeOrder(\\n        Tree storage self,\\n        uint256 value,\\n        uint48 orderId\\n    ) internal returns (uint256 amount) {\\n        require(\\n            isActiveOrderId(self, value, orderId),\\n            \\\"OrderStatisticsTreeLib: Order does not exist\\\"\\n        );\\n        Node storage gn = self.nodes[value];\\n\\n        OrderItem memory order = gn.orders[orderId];\\n        amount = order.amount;\\n\\n        if (gn.head == orderId && gn.tail == orderId) {\\n            _setHead(self, value, 0);\\n            _setTail(self, value, 0);\\n        } else if (gn.head == orderId) {\\n            _setHead(self, value, order.next);\\n            gn.orders[order.next].prev = 0;\\n        } else if (gn.tail == orderId) {\\n            _setTail(self, value, order.prev);\\n            gn.orders[order.prev].next = 0;\\n        } else {\\n            _link(self, value, order.prev, order.next);\\n        }\\n        delete gn.orders[order.orderId];\\n        gn.orderCounter -= 1;\\n        gn.orderTotalAmount -= order.amount;\\n    }\\n\\n    /**\\n     * @dev Remove the OrderItems older than or equal `orderId` from the list\\n     */\\n    function _removeOrders(Tree storage self, uint256 value, uint48 orderId) internal {\\n        require(\\n            isActiveOrderId(self, value, orderId),\\n            \\\"OrderStatisticsTreeLib: Order does not exist\\\"\\n        );\\n        Node storage gn = self.nodes[value];\\n\\n        OrderItem memory order = gn.orders[orderId];\\n        uint48 cursor = gn.head;\\n        uint256 removedCount = 1;\\n        uint256 removedAmount = gn.orders[cursor].amount;\\n\\n        while (cursor != orderId) {\\n            cursor = gn.orders[cursor].next;\\n            removedCount++;\\n            removedAmount += gn.orders[cursor].amount;\\n        }\\n\\n        if (gn.tail == orderId) {\\n            _setHead(self, value, 0);\\n            _setTail(self, value, 0);\\n        } else {\\n            _setHead(self, value, order.next);\\n            gn.orders[order.next].prev = 0;\\n        }\\n\\n        gn.orderCounter -= removedCount;\\n        gn.orderTotalAmount -= removedAmount;\\n    }\\n\\n    /**\\n     * @dev Internal function to update the Head pointer.\\n     */\\n    function _setHead(Tree storage self, uint256 value, uint48 orderId) internal {\\n        Node storage gn = self.nodes[value];\\n\\n        gn.head = orderId;\\n    }\\n\\n    /**\\n     * @dev Internal function to update the Tail pointer.\\n     */\\n    function _setTail(Tree storage self, uint256 value, uint48 orderId) internal {\\n        Node storage gn = self.nodes[value];\\n\\n        gn.tail = orderId;\\n    }\\n\\n    /**\\n     * @dev Internal function to link an Object to another.\\n     */\\n    function _link(Tree storage self, uint256 value, uint48 prevId, uint48 nextId) internal {\\n        Node storage gn = self.nodes[value];\\n\\n        gn.orders[prevId].next = nextId;\\n        gn.orders[nextId].prev = prevId;\\n    }\\n\\n    function _calculateFutureValue(\\n        uint256 unitPrice,\\n        uint256 amount\\n    ) internal pure returns (uint256) {\\n        return (amount * Constants.PRICE_DIGIT).div(unitPrice);\\n    }\\n\\n    function _calculatePresentValue(\\n        uint256 unitPrice,\\n        uint256 amount\\n    ) internal pure returns (uint256) {\\n        return (amount * unitPrice).div(Constants.PRICE_DIGIT);\\n    }\\n}\\n\",\"keccak256\":\"0x7e726e6f70fd1ef9d56b3104a1a2963fc121a578313227b9dd087d81e9222a0b\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/libraries/logics/OrderBookLogic.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nimport {Constants} from \\\"../Constants.sol\\\";\\nimport {OrderBookLib, FilledOrder, PartiallyFilledOrder} from \\\"../OrderBookLib.sol\\\";\\nimport {ProtocolTypes} from \\\"../../types/ProtocolTypes.sol\\\";\\nimport {LendingMarketStorage as Storage, ItayoseLog} from \\\"../../storages/LendingMarketStorage.sol\\\";\\nimport {RoundingUint256} from \\\"../math/RoundingUint256.sol\\\";\\nimport {ILendingMarket} from \\\"../../interfaces/ILendingMarket.sol\\\";\\n\\nlibrary OrderBookLogic {\\n    using OrderBookLib for OrderBookLib.OrderBook;\\n    using RoundingUint256 for uint256;\\n\\n    error InvalidOrderFeeRate();\\n    error InvalidCircuitBreakerLimitRange();\\n    error OrderBookNotMatured();\\n\\n    event OrderFeeRateUpdated(bytes32 ccy, uint256 previousRate, uint256 rate);\\n    event CircuitBreakerLimitRangeUpdated(bytes32 ccy, uint256 previousRate, uint256 rate);\\n    event OrderBookCreated(uint8 orderBookId, uint256 maturity, uint256 openingDate);\\n\\n    event ItayoseExecuted(\\n        bytes32 ccy,\\n        uint256 maturity,\\n        uint256 openingUnitPrice,\\n        uint256 lastLendUnitPrice,\\n        uint256 lastBorrowUnitPrice,\\n        uint256 offsetAmount\\n    );\\n\\n    function isReady(uint8 _orderBookId) public view returns (bool) {\\n        return Storage.slot().isReady[_getOrderBook(_orderBookId).maturity];\\n    }\\n\\n    function isMatured(uint8 _orderBookId) public view returns (bool) {\\n        return _getOrderBook(_orderBookId).isMatured();\\n    }\\n\\n    function isOpened(uint8 _orderBookId) public view returns (bool) {\\n        return\\n            isReady(_orderBookId) &&\\n            !isMatured(_orderBookId) &&\\n            block.timestamp >= _getOrderBook(_orderBookId).openingDate;\\n    }\\n\\n    function isItayosePeriod(uint8 _orderBookId) public view returns (bool) {\\n        return\\n            block.timestamp >=\\n            (_getOrderBook(_orderBookId).openingDate - OrderBookLib.ITAYOSE_PERIOD) &&\\n            !isReady(_orderBookId);\\n    }\\n\\n    function isPreOrderPeriod(uint8 _orderBookId) public view returns (bool) {\\n        OrderBookLib.OrderBook storage orderBook = _getOrderBook(_orderBookId);\\n        return\\n            block.timestamp >= orderBook.preOpeningDate &&\\n            block.timestamp < (orderBook.openingDate - OrderBookLib.ITAYOSE_PERIOD);\\n    }\\n\\n    function getOrderBookDetail(\\n        uint8 _orderBookId\\n    )\\n        public\\n        view\\n        returns (bytes32 ccy, uint256 maturity, uint256 openingDate, uint256 preOpeningDate)\\n    {\\n        OrderBookLib.OrderBook storage orderBook = _getOrderBook(_orderBookId);\\n\\n        ccy = Storage.slot().ccy;\\n        maturity = orderBook.maturity;\\n        openingDate = orderBook.openingDate;\\n        preOpeningDate = orderBook.preOpeningDate;\\n    }\\n\\n    function getLastOrderTimestamp(uint8 _orderBookId) external view returns (uint48) {\\n        return _getOrderBook(_orderBookId).lastOrderTimestamp;\\n    }\\n\\n    function getBlockUnitPriceHistory(\\n        uint8 _orderBookId\\n    ) external view returns (uint256[] memory unitPrices, uint48 timestamp) {\\n        return _getOrderBook(_orderBookId).getBlockUnitPriceHistory(true);\\n    }\\n\\n    function getMarketUnitPrice(uint8 _orderBookId) external view returns (uint256) {\\n        return _getOrderBook(_orderBookId).getMarketUnitPrice(true);\\n    }\\n\\n    function getBlockUnitPriceAverage(\\n        uint8 _orderBookId,\\n        uint256 _count\\n    ) external view returns (uint256) {\\n        return _getOrderBook(_orderBookId).getBlockUnitPriceAverage(_count, true);\\n    }\\n\\n    function getCircuitBreakerThresholds(\\n        uint8 _orderBookId\\n    ) external view returns (uint256 maxLendUnitPrice, uint256 minBorrowUnitPrice) {\\n        maxLendUnitPrice = _getOrderBook(_orderBookId).getLendCircuitBreakerThreshold(\\n            Storage.slot().circuitBreakerLimitRange,\\n            true\\n        );\\n        minBorrowUnitPrice = _getOrderBook(_orderBookId).getBorrowCircuitBreakerThreshold(\\n            Storage.slot().circuitBreakerLimitRange,\\n            true\\n        );\\n    }\\n\\n    function getBestLendUnitPrice(uint8 _orderBookId) public view returns (uint256) {\\n        return _getOrderBook(_orderBookId).getBestLendUnitPrice();\\n    }\\n\\n    function getBestLendUnitPrices(\\n        uint8[] memory _orderBookIds\\n    ) external view returns (uint256[] memory unitPrices) {\\n        unitPrices = new uint256[](_orderBookIds.length);\\n\\n        for (uint256 i; i < _orderBookIds.length; i++) {\\n            unitPrices[i] = _getOrderBook(_orderBookIds[i]).getBestLendUnitPrice();\\n        }\\n    }\\n\\n    function getBestBorrowUnitPrice(uint8 _orderBookId) public view returns (uint256) {\\n        return _getOrderBook(_orderBookId).getBestBorrowUnitPrice();\\n    }\\n\\n    function getBestBorrowUnitPrices(\\n        uint8[] memory _orderBookIds\\n    ) external view returns (uint256[] memory unitPrices) {\\n        unitPrices = new uint256[](_orderBookIds.length);\\n\\n        for (uint256 i; i < _orderBookIds.length; i++) {\\n            unitPrices[i] = _getOrderBook(_orderBookIds[i]).getBestBorrowUnitPrice();\\n        }\\n    }\\n\\n    function getBorrowOrderBook(\\n        uint8 _orderBookId,\\n        uint256 _start,\\n        uint256 _limit\\n    )\\n        external\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        )\\n    {\\n        return _getOrderBook(_orderBookId).getBorrowOrderBook(_start, _limit);\\n    }\\n\\n    function getLendOrderBook(\\n        uint8 _orderBookId,\\n        uint256 _start,\\n        uint256 _limit\\n    )\\n        external\\n        view\\n        returns (\\n            uint256[] memory unitPrices,\\n            uint256[] memory amounts,\\n            uint256[] memory quantities,\\n            uint256 next\\n        )\\n    {\\n        return _getOrderBook(_orderBookId).getLendOrderBook(_start, _limit);\\n    }\\n\\n    function getItayoseEstimation(\\n        uint8 _orderBookId\\n    )\\n        external\\n        view\\n        returns (\\n            uint256 openingUnitPrice,\\n            uint256 lastLendUnitPrice,\\n            uint256 lastBorrowUnitPrice,\\n            uint256 totalOffsetAmount\\n        )\\n    {\\n        return _getOrderBook(_orderBookId).calculateItayoseResult();\\n    }\\n\\n    function getMaturities(\\n        uint8[] memory _orderBookIds\\n    ) public view returns (uint256[] memory maturities) {\\n        maturities = new uint256[](_orderBookIds.length);\\n\\n        for (uint256 i; i < _orderBookIds.length; i++) {\\n            maturities[i] = _getOrderBook(_orderBookIds[i]).maturity;\\n        }\\n    }\\n\\n    function updateOrderFeeRate(uint256 _orderFeeRate) external {\\n        if (_orderFeeRate >= Constants.PCT_DIGIT) revert InvalidOrderFeeRate();\\n\\n        uint256 previousRate = Storage.slot().orderFeeRate;\\n\\n        if (_orderFeeRate != previousRate) {\\n            Storage.slot().orderFeeRate = _orderFeeRate;\\n\\n            emit OrderFeeRateUpdated(Storage.slot().ccy, previousRate, _orderFeeRate);\\n        }\\n    }\\n\\n    function updateCircuitBreakerLimitRange(uint256 _cbLimitRange) external {\\n        if (_cbLimitRange >= Constants.PCT_DIGIT) revert InvalidCircuitBreakerLimitRange();\\n\\n        uint256 previousRange = Storage.slot().circuitBreakerLimitRange;\\n\\n        if (_cbLimitRange != previousRange) {\\n            Storage.slot().circuitBreakerLimitRange = _cbLimitRange;\\n\\n            emit CircuitBreakerLimitRangeUpdated(Storage.slot().ccy, previousRange, _cbLimitRange);\\n        }\\n    }\\n\\n    function createOrderBook(\\n        uint256 _maturity,\\n        uint256 _openingDate,\\n        uint256 _preOpeningDate\\n    ) public returns (uint8 orderBookId) {\\n        orderBookId = _nextOrderBookId();\\n\\n        Storage.slot().isReady[_maturity] = _getOrderBook(orderBookId).initialize(\\n            _maturity,\\n            _openingDate,\\n            _preOpeningDate\\n        );\\n\\n        emit OrderBookCreated(orderBookId, _maturity, _openingDate);\\n    }\\n\\n    function executeAutoRoll(\\n        uint8 _maturedOrderBookId,\\n        uint8 _destinationOrderBookId,\\n        uint256 _autoRollUnitPrice\\n    ) external {\\n        OrderBookLib.OrderBook storage maturedOrderBook = Storage.slot().orderBooks[\\n            _maturedOrderBookId\\n        ];\\n\\n        if (!maturedOrderBook.isMatured()) revert OrderBookNotMatured();\\n\\n        OrderBookLib.OrderBook storage destinationOrderBook = Storage.slot().orderBooks[\\n            _destinationOrderBookId\\n        ];\\n\\n        // NOTE: The auto-roll destination order book has no market unit price if the order has never been filled before.\\n        // In this case, the market unit price is updated with the unit price of the auto-roll.\\n        if (destinationOrderBook.getMarketUnitPrice(false) == 0) {\\n            destinationOrderBook.setInitialBlockUnitPrice(_autoRollUnitPrice);\\n        }\\n    }\\n\\n    function executeItayoseCall(\\n        uint8 _orderBookId\\n    )\\n        external\\n        returns (\\n            uint256 openingUnitPrice,\\n            uint256 totalOffsetAmount,\\n            uint256 openingDate,\\n            PartiallyFilledOrder memory partiallyFilledLendingOrder,\\n            PartiallyFilledOrder memory partiallyFilledBorrowingOrder\\n        )\\n    {\\n        uint256 lastLendUnitPrice;\\n        uint256 lastBorrowUnitPrice;\\n        OrderBookLib.OrderBook storage orderBook = _getOrderBook(_orderBookId);\\n\\n        (openingUnitPrice, lastLendUnitPrice, lastBorrowUnitPrice, totalOffsetAmount) = orderBook\\n            .calculateItayoseResult();\\n\\n        if (totalOffsetAmount > 0) {\\n            ProtocolTypes.Side[2] memory sides = [\\n                ProtocolTypes.Side.LEND,\\n                ProtocolTypes.Side.BORROW\\n            ];\\n\\n            for (uint256 i; i < sides.length; i++) {\\n                ProtocolTypes.Side partiallyFilledOrderSide;\\n                PartiallyFilledOrder memory partiallyFilledOrder;\\n                FilledOrder memory filledOrder;\\n                (filledOrder, partiallyFilledOrder, , ) = orderBook.fillOrders(\\n                    sides[i],\\n                    totalOffsetAmount,\\n                    0,\\n                    0\\n                );\\n\\n                if (filledOrder.futureValue > 0) {\\n                    orderBook.setInitialBlockUnitPrice(openingUnitPrice);\\n                }\\n\\n                if (partiallyFilledOrder.futureValue > 0) {\\n                    if (sides[i] == ProtocolTypes.Side.LEND) {\\n                        partiallyFilledOrderSide = ProtocolTypes.Side.BORROW;\\n                        partiallyFilledBorrowingOrder = partiallyFilledOrder;\\n                    } else {\\n                        partiallyFilledOrderSide = ProtocolTypes.Side.LEND;\\n                        partiallyFilledLendingOrder = partiallyFilledOrder;\\n                    }\\n                }\\n            }\\n\\n            emit ItayoseExecuted(\\n                Storage.slot().ccy,\\n                orderBook.maturity,\\n                openingUnitPrice,\\n                lastLendUnitPrice,\\n                lastBorrowUnitPrice,\\n                totalOffsetAmount\\n            );\\n        }\\n\\n        Storage.slot().isReady[orderBook.maturity] = true;\\n        Storage.slot().itayoseLogs[orderBook.maturity] = ItayoseLog(\\n            openingUnitPrice,\\n            lastLendUnitPrice,\\n            lastBorrowUnitPrice\\n        );\\n        openingDate = orderBook.openingDate;\\n    }\\n\\n    function _nextOrderBookId() internal returns (uint8) {\\n        // NOTE: Originally, matured ordebooks were reused as new orderbooks after auto-rolls, but this reusing logic has been removed.\\n        // This means that `orderBookId` is increased in proportion to the number of auto-rolls executed. To avoid overflow of `orderBookId`,\\n        // `orderBookId` circulate between 1 and 255.\\n        if (Storage.slot().lastOrderBookId == type(uint8).max) {\\n            Storage.slot().lastOrderBookId = 1;\\n        } else {\\n            Storage.slot().lastOrderBookId++;\\n        }\\n        return Storage.slot().lastOrderBookId;\\n    }\\n\\n    function _getOrderBook(\\n        uint8 _orderBookId\\n    ) private view returns (OrderBookLib.OrderBook storage) {\\n        return Storage.slot().orderBooks[_orderBookId];\\n    }\\n}\\n\",\"keccak256\":\"0xfb21d8826a9cda0c4184830a2d29351131632a475bdc7689c211fb64b2255bef\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/libraries/math/RoundingUint256.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nlibrary RoundingUint256 {\\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\\n        require(b > 0);\\n\\n        if ((a * 10) / b - (a / b) * 10 < 5) {\\n            return a / b;\\n        } else {\\n            return (a / b) + 1;\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0xb063c0e8aa8a0bfc9303bd5a1c1d9f54b19cb85d8859aa505ba4162769fc7306\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/storages/LendingMarketStorage.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\nimport {ProtocolTypes} from \\\"../types/ProtocolTypes.sol\\\";\\nimport {OrderBookLib} from \\\"../libraries/OrderBookLib.sol\\\";\\n\\nstruct ItayoseLog {\\n    uint256 openingUnitPrice;\\n    uint256 lastLendUnitPrice;\\n    uint256 lastBorrowUnitPrice;\\n}\\n\\nlibrary LendingMarketStorage {\\n    bytes32 internal constant STORAGE_SLOT =\\n        bytes32(uint256(keccak256(\\\"sf.storage.lendingMarket\\\")) - 1);\\n\\n    struct Storage {\\n        bytes32 ccy;\\n        uint8 lastOrderBookId;\\n        // Order fee rate received by protocol (in basis point)\\n        uint256 orderFeeRate;\\n        // Rate limit range of yield for the circuit breaker\\n        uint256 circuitBreakerLimitRange;\\n        // Mapping from order book id to order book\\n        mapping(uint8 orderBookId => OrderBookLib.OrderBook orderBook) orderBooks;\\n        mapping(uint256 maturity => bool isReady) isReady;\\n        mapping(uint256 maturity => ItayoseLog log) itayoseLogs;\\n    }\\n\\n    function slot() internal pure returns (Storage storage r) {\\n        bytes32 _slot = STORAGE_SLOT;\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            r.slot := _slot\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0x24513c09dd69dfd90b98650daa4656722f7cd8724c18e6740afa339a7de2b920\",\"license\":\"BUSL-1.1\"},\"contracts/protocol/types/ProtocolTypes.sol\":{\"content\":\"// SPDX-License-Identifier: BUSL-1.1\\npragma solidity 0.8.19;\\n\\n/**\\n * @dev ProtocolTypes is a base-level contract that holds common Secured Finance protocol types\\n * @author Secured Finance\\n */\\nlibrary ProtocolTypes {\\n    enum Side {\\n        LEND,\\n        BORROW\\n    }\\n}\\n\",\"keccak256\":\"0x409169980b48b1bd32af609ac7b90f5c29e064cbec3d83d81767d72192ba07a2\",\"license\":\"BUSL-1.1\"}},\"version\":1}",
  "bytecode": "0x61373161003a600b82828239805160001a60731461002d57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600436106101625760003560e01c80636aa65aaf116100cd578063a3b88aa011610086578063a3b88aa0146103aa578063ba1cbe98146103bd578063cd458662146103d0578063dded339b146103e3578063fbb759b4146103f6578063fffa87b81461042057600080fd5b80636aa65aaf146102df5780636c5d6df11461030157806380d5b6091461032157806382bdfed51461035457806389efbab1146103675780639beff3e31461038a57600080fd5b806350e187011161011f57806350e18701146102395780635575c79614610261578063576737171461029357806358e64897146102a65780635f7f8b45146102b95780636a5138d6146102cc57600080fd5b80631f98a42014610167578063261cc1b21461019157806329d6dd13146101c25780632bfa7c13146101e5578063381e93441461020657806338b0585214610219575b600080fd5b61017a610175366004613296565b610433565b6040516101889291906132ec565b60405180910390f35b81801561019d57600080fd5b506101b16101ac366004613296565b610454565b604051610188959493929190613316565b6101d56101d0366004613296565b61068a565b6040519015158152602001610188565b6101f86101f3366004613296565b6106bd565b604051908152602001610188565b6101d5610214366004613296565b6106d9565b61022c6102273660046133c1565b61070f565b604051610188919061347a565b61024c610247366004613296565b6107be565b60408051928352602083019190915201610188565b81801561026d57600080fd5b5061028161027c36600461348d565b61080c565b60405160ff9091168152602001610188565b61022c6102a13660046133c1565b6108a4565b6101f86102b4366004613296565b610944565b6101f86102c7366004613296565b610952565b6101d56102da366004613296565b610965565b8180156102eb57600080fd5b506102ff6102fa3660046134b9565b61099f565b005b81801561030d57600080fd5b506102ff61031c3660046134b9565b610a32565b61033461032f366004613296565b610aa1565b604080519485526020850193909352918301526060820152608001610188565b6101d5610362366004613296565b610ad9565b61037a6103753660046134d2565b610aee565b6040516101889493929190613505565b81801561039657600080fd5b506102ff6103a5366004613550565b610b1b565b6101f86103b836600461358c565b610baa565b61037a6103cb3660046134d2565b610bc9565b61022c6103de3660046133c1565b610be5565b6103346103f1366004613296565b610c80565b610409610404366004613296565b610ca7565b60405165ffffffffffff9091168152602001610188565b6101d561042e366004613296565b610ccb565b6060600061044b600161044585610d03565b90610d28565b91509150915091565b600080600061046161324c565b61046961324c565b600080600061047789610d03565b905061048281610e92565b929a509198509350915086156105ee57604080518082019091526000808252600160208301525b600281101561058b5760006104bc61324c565b6104e76040518060800160405280600081526020016000815260200160008152602001600081525090565b61050c8585600281106104fc576104fc6135cc565b602002015187908e6000806110af565b505060408201519093509091501561052857610528868e6111fa565b606082015115610575576000858560028110610546576105466135cc565b6020020151600181111561055c5761055c6135b6565b0361056d5760019250819850610575565b600092508199505b5050508080610583906135f8565b9150506104a9565b507fa9952c3d01896ca75bba3aede761be10089d8d4725c9fee6b99245515986ef606105b5611266565b54835460408051928352602083019190915281018b9052606081018690526080810185905260a081018a905260c00160405180910390a1505b60016105f8611266565b825460009081526005919091016020908152604091829020805460ff19169315159390931790925580516060810182528a8152918201859052810183905261063e611266565b6006016000836000015481526020019081526020016000206000820151816000015560208201518160010155604082015181600201559050508060010154955050505091939590929450565b6000610694611266565b60050160006106a284610d03565b54815260208101919091526040016000205460ff1692915050565b60006106d360016106cd84610d03565b90611294565b92915050565b6000610e106106e783610d03565b600101546106f59190613611565b42101580156106d357506107088261068a565b1592915050565b6060815167ffffffffffffffff81111561072b5761072b6133ab565b604051908082528060200260200182016040528015610754578160200160208202803683370190505b50905060005b82518110156107b857610785838281518110610778576107786135cc565b6020026020010151610d03565b6000015482828151811061079b5761079b6135cc565b6020908102919091010152806107b0816135f8565b91505061075a565b50919050565b6000806107e26107cc611266565b6003015460016107db86610d03565b919061133a565b91506108056107ef611266565b6003015460016107fe86610d03565b91906113bb565b9050915091565b6000610816611420565b905061082f84848461082785610d03565b9291906114a6565b610837611266565b60008681526005919091016020908152604091829020805460ff191693151593909317909255805160ff8416815291820186905281018490527f04ec0e7cdb609ffd421993d30756b50a4c420e88ce7f59bb3e29b5a8fe1fcf4a9060600160405180910390a19392505050565b6060815167ffffffffffffffff8111156108c0576108c06133ab565b6040519080825280602002602001820160405280156108e9578160200160208202803683370190505b50905060005b82518110156107b857610915610910848381518110610778576107786135cc565b6114fd565b828281518110610927576109276135cc565b60209081029190910101528061093c816135f8565b9150506108ef565b60006106d361091083610d03565b60006106d361096083610d03565b611518565b60006109708261068a565b8015610982575061098082610ad9565b155b80156106d3575061099282610d03565b6001015442101592915050565b61271081106109c157604051636d3872b560e11b815260040160405180910390fd5b60006109cb611266565b600201549050808214610a2e57816109e1611266565b600201557fad24e9bff76148b1b779fc330ea225198d2b44136c7a8e5fbec46c99c7775632610a0e611266565b546040805191825260208201849052810184905260600160405180910390a15b5050565b6127108110610a5457604051631ce2ca3b60e31b815260040160405180910390fd5b6000610a5e611266565b600301549050808214610a2e5781610a74611266565b600301557fee52d515b96986517a19b501c0a50b03f4edace46ba0484faaea7590969adcf6610a0e611266565b6000806000806000610ab286610d03565b9050610abc611266565b548154600183015460029093015491989097509195509350915050565b60006106d3610ae783610d03565b5442101590565b60608060606000610b0a8686610b038a610d03565b919061154d565b935093509350935093509350935093565b6000610b25611266565b60ff85166000908152600491909101602052604090209050610b48815442101590565b610b6557604051632e98f16560e11b815260040160405180910390fd5b6000610b6f611266565b60ff85166000908152600491909101602052604081209150610b92908290611294565b600003610ba357610ba381846111fa565b5050505050565b6000610bc2826001610bbb86610d03565b9190611866565b9392505050565b60608060606000610b0a8686610bde8a610d03565b91906119a2565b6060815167ffffffffffffffff811115610c0157610c016133ab565b604051908082528060200260200182016040528015610c2a578160200160208202803683370190505b50905060005b82518110156107b857610c51610960848381518110610778576107786135cc565b828281518110610c6357610c636135cc565b602090810291909101015280610c78816135f8565b915050610c30565b600080600080610c97610c9286610d03565b610e92565b93509350935093505b9193509193565b6000610cb282610d03565b60030154600160301b900465ffffffffffff1692915050565b600080610cd783610d03565b905080600201544210158015610bc25750610e108160010154610cfa9190613611565b42109392505050565b6000610d0d611266565b60ff9092166000908152600492909201602052506040902090565b60606000610d4c84600301600d9054906101000a90046001600160501b0316611cae565b600385015490925065ffffffffffff600160301b9091041642141580610d8c575081600081518110610d8057610d806135cc565b60200260200101516000145b80610d945750825b8015610dab57506003840154600160601b900460ff165b15610e7557600060018351610dc09190613611565b90505b8015610e1c5782610dd5600183613611565b81518110610de557610de56135cc565b6020026020010151838281518110610dff57610dff6135cc565b602090810291909101015280610e1481613624565b915050610dc3565b50610e3d84600501546127108660040154610e37919061363b565b90611dbe565b82600081518110610e5057610e506135cc565b6020908102919091010152506003830154600160301b900465ffffffffffff16610e8b565b506003830154600160b81b900465ffffffffffff165b9250929050565b80546000908152600b8201602052604081208190819081908190610eb590611e2f565b86546000908152600c88016020526040812091925090610ed490611e76565b87546000908152600b8901602090815260408083208684526001019091528120600501549192509088546000908152600c8a01602090815260408083208684526001019091528120600501549192509089546000908152600c8b0160209081526040808320600b8e019092529091209192509085851180610f53575084155b80610f5c575085155b15610f7a576000806000809950995099509950505050505050610ca0565b858511158015610f8a5750600085115b8015610f965750600086115b156110a25785985084975082841115610fef578599508287610fb89190613652565b9650610fc48385613611565b9350610fd08286611eb8565b60008181526001840160205260409020600501549095505b9250610f7a565b8284101561103c5784995083876110069190613652565b96506110128484613611565b925061101e8187611f6a565b60008181526001830160205260409020600501549096509350610f7a565b61104b6002610e378789613652565b99506110578488613652565b96506110638187611f6a565b955061106f8286611eb8565b60008781526001830160205260409020600501549095506000868152600184016020526040902060050154909450610fe8565b5050505050509193509193565b6110da6040518060800160405280600081526020016000815260200160008152602001600081525090565b6110e261324c565b6000806110ed61324c565b6001896001811115611101576111016135b6565b0361114d5789546000908152600b8b0160205260409020611124818a8a8a612013565b60408b01929092529189526020890192909252945091506111458154151590565b9250506111a9565b6000896001811115611161576111616135b6565b036111a95789546000908152600c8b0160205260409020611184818a8a8a61225d565b60408b01929092529189526020890192909252945091506111a58154151590565b9250505b6040518060800160405280826000015165ffffffffffff16815260200182602001516001600160a01b0316815260200182604001518152602001826060015181525093505095509550955095915050565b60039190910180546fffffffffffffffffffffffffffffffff60681b191661ffff909216600160681b0265ffffffffffff60b81b191691909117600160b81b4265ffffffffffff16908102919091176bffffffffffff0000000000001916600160301b91909102179055565b6000806106d360017ffc2836757f9146445fc75bc3c897a210ec004e4ee60fc8627ef5cbf2842b3d0a613611565b60038201546000906112b590600160681b90046001600160501b0316611cae565b6000815181106112c7576112c76135cc565b60200260200101519050428360030160069054906101000a900465ffffffffffff1665ffffffffffff161415806112fc575080155b806113045750815b801561131b57506003830154600160601b900460ff165b156106d357610bc283600501546127108560040154610e37919061363b565b60008061134985600385611866565b905061137261271061135c86600261363b565b61136890612710613652565b610e37908461363b565b9150612710821180611382575080155b156113915761271091506113b3565b61139d6102bc82613652565b8210156113b3576113b06102bc82613652565b91505b509392505050565b6000806113ca85600585611866565b90506113dc6127106113688682613611565b91508115806113e9575080155b806113f5575060c88111155b1561140357600191506113b3565b61140e60c883613652565b8110156113b3576113b060c882613611565b600060ff61142c611266565b6001015460ff160361145c576001611442611266565b600101805460ff191660ff92909216919091179055611492565b611464611266565b600101805460ff1690600061147883613665565b91906101000a81548160ff021916908360ff160217905550505b61149a611266565b6001015460ff16919050565b8284556001840182905560028401819055600060048501819055600585018190556003850180546601000000000000600160e81b03191690556114eb610e1084613611565b42106114f5575060015b949350505050565b80546000908152600b8201602052604081206106d390611e2f565b80546000908152600c820160205260408120819061153590611e76565b905080156115435780610bc2565b6127109392505050565b606080606060008467ffffffffffffffff81111561156d5761156d6133ab565b604051908082528060200260200182016040528015611596578160200160208202803683370190505b5093508467ffffffffffffffff8111156115b2576115b26133ab565b6040519080825280602002602001820160405280156115db578160200160208202803683370190505b5092508467ffffffffffffffff8111156115f7576115f76133ab565b604051908082528060200260200182016040528015611620578160200160208202803683370190505b50915060008660000361164f5787546000908152600c89016020526040902061164890611e76565b90506116b1565b87546000908152600c890160205260408120819061166d908a6124ab565b91509150811561167f578892506116ae565b8881111561168f578092506116ae565b89546000908152600c8b01602052604090206116ab9082611eb8565b92505b50505b80856000815181106116c5576116c56135cc565b60209081029190910181019190915288546000908152600c8a0182526040808220848352600101909252206005015484600081518110611707576117076135cc565b60209081029190910181019190915288546000908152600c8a0182526040808220848352600101909252206004015483600081518110611749576117496135cc565b602090810291909101015260015b85518110156118365781156118365788546000908152600c8a01602052604090206117829083611eb8565b915081868281518110611797576117976135cc565b60209081029190910181019190915289546000908152600c8b018252604080822085835260010190925220600501548582815181106117d8576117d86135cc565b60209081029190910181019190915289546000908152600c8b01825260408082208583526001019092522060040154848281518110611819576118196135cc565b60209081029190910101528061182e816135f8565b915050611757565b50801561185c5787546000908152600c8901602052604090206118599082611eb8565b91505b5093509350935093565b60008061188985600301600d9054906101000a90046001600160501b0316611cae565b8051600387015491925090600090819065ffffffffffff600160301b90910416421415806118b45750855b80156118cb57506003880154600160601b900460ff165b156118fe576118ea88600501546127108a60040154610e37919061363b565b915060019050866118fa81613624565b9750505b60005b8781101561197c5783811015806119315750848181518110611925576119256135cc565b60200260200101516000145b61197c57848181518110611947576119476135cc565b60200260200101518361195a9190613652565b925081611966816135f8565b9250508080611974906135f8565b915050611901565b506000811161198c576000611996565b6119968282611dbe565b98975050505050505050565b606080606060008467ffffffffffffffff8111156119c2576119c26133ab565b6040519080825280602002602001820160405280156119eb578160200160208202803683370190505b5093508467ffffffffffffffff811115611a0757611a076133ab565b604051908082528060200260200182016040528015611a30578160200160208202803683370190505b5092508467ffffffffffffffff811115611a4c57611a4c6133ab565b604051908082528060200260200182016040528015611a75578160200160208202803683370190505b509150600086600003611aa45787546000908152600b890160205260409020611a9d90611e2f565b9050611b06565b87546000908152600b8901602052604081208190611ac2908a6124ab565b915091508115611ad457889250611b03565b88811015611ae457809250611b03565b89546000908152600b8b0160205260409020611b009082611f6a565b92505b50505b8085600081518110611b1a57611b1a6135cc565b60209081029190910181019190915288546000908152600b8a0182526040808220848352600101909252206005015484600081518110611b5c57611b5c6135cc565b60209081029190910181019190915288546000908152600b8a0182526040808220848352600101909252206004015483600081518110611b9e57611b9e6135cc565b602090810291909101015260015b8551811015611c8b578115611c8b5788546000908152600b8a0160205260409020611bd79083611f6a565b915081868281518110611bec57611bec6135cc565b60209081029190910181019190915289546000908152600b8b01825260408082208583526001019092522060050154858281518110611c2d57611c2d6135cc565b60209081029190910181019190915289546000908152600b8b01825260408082208583526001019092522060040154848281518110611c6e57611c6e6135cc565b602090810291909101015280611c83816135f8565b915050611bac565b50801561185c5787546000908152600b8901602052604090206118599082611f6a565b60408051600580825260c082019092526060916020820160a0803683370190505090508161ffff1681600081518110611ce957611ce96135cc565b6020026020010181815250506010826001600160501b0316901c61ffff1681600181518110611d1a57611d1a6135cc565b6020026020010181815250506020826001600160501b0316901c61ffff1681600281518110611d4b57611d4b6135cc565b6020026020010181815250506030826001600160501b0316901c61ffff1681600381518110611d7c57611d7c6135cc565b6020026020010181815250506040826001600160501b0316901c61ffff1681600481518110611dad57611dad6135cc565b602002602001018181525050919050565b6000808211611dcc57600080fd5b6005611dd88385613684565b611de390600a61363b565b83611def86600a61363b565b611df99190613684565b611e039190613611565b1015611e1a57611e138284613684565b90506106d3565b611e248284613684565b611e13906001613652565b805480611e3e57506000919050565b5b600081815260018301602052604090206002015415611e71576000908152600182016020526040902060020154611e3f565b919050565b805480611e8557506000919050565b5b600081815260018084016020526040909120015415611e71576000908152600180830160205260409091200154611e86565b600081611ee05760405162461bcd60e51b8152600401611ed7906136a6565b60405180910390fd5b600082815260018401602052604090206002015415611f18576000828152600184016020526040902060020154611e13908490612510565b5060008181526001830160205260409020545b8015801590611f4c5750600081815260018401602052604090206002015482145b156106d3576000818152600184016020526040902054909150611f2b565b600081611f895760405162461bcd60e51b8152600401611ed7906136a6565b600082815260018085016020526040909120015415611fc1576000828152600180850160205260409091200154611e13908490612548565b5060008181526001830160205260409020545b8015801590611ff55750600081815260018085016020526040909120015482145b156106d3576000818152600184016020526040902054909150611fd4565b60008060008061202161324c565b600061202c8a611e2f565b905060008060008984101580612040575089155b6120875760405162461bcd60e51b8152602060048201526018602482015277496e73756666696369656e74206c696d69742076616c756560401b6044820152606401611ed7565b6120948d8d8d8d8861257f565b959e50919c509a5091965094509250905060006120b1838a613652565b905080156121a65782156120dd578994506120d68e866120d18688613611565b6126aa565b9550612102565b8115612102578994506120ff8e866120f588866129c1565b6120d19088613611565b95505b600085815260018f016020526040812060028101919091555485156121a4575b80156121a4578581101561218e57808f6001016000888152602001908152602001600020600001541461218a57808f600101600088815260200190815260200160002060000181905550858f6001016000838152602001908152602001600020600201819055505b8095505b600090815260018f016020526040902054612122565b505b808d11156121bb576121b8818e613611565b96505b60006121c68f611e76565b90508a811480156121ef57508e6001016000828152602001908152602001600020600501546000145b156121fd5760008f55612243565b8e548b108061221657508e548b1480156122165750818a145b1561224357858f6000018190555060008f6001016000888152602001908152602001600020600001819055505b61224c8f6129d3565b505050505050945094509450945094565b60008060008061226b61324c565b60006122768a611e76565b90506000806000898411158061228a575089155b6122d15760405162461bcd60e51b8152602060048201526018602482015277496e73756666696369656e74206c696d69742076616c756560401b6044820152606401611ed7565b6122de8d8d8d8d88612aa2565b959e50919c509a5091965094509250905060006122fb838a613652565b905080156124055782156123225789945061231b8e866120d18688613611565b955061233d565b811561233d5789945061233a8e866120f588866129c1565b95505b60008e60010160008781526020019081526020016000206001018190555060008e600101600087815260200190815260200160002060000154905060008614612403575b801561240357858111156123ed57808f600101600088815260200190815260200160002060000154146123e957808f600101600088815260200190815260200160002060000181905550858f6001016000838152602001908152602001600020600101819055505b8095505b600090815260018f016020526040902054612381565b505b808d111561241a57612417818e613611565b96505b60006124258f611e2f565b90508a8114801561244e57508e6001016000828152602001908152602001600020600501546000145b1561245c5760008f556124a2565b8e548b118061247557508e548b1480156124755750818a145b156124a257858f6000018190555060008f6001016000888152602001908152602001600020600001819055505b61224c8f612b98565b815460009081905b801561250557808410156124dd5760008181526001808701602052604090912001549091506124fd565b808411156124fd5760008181526001860160205260409020600201549091505b8381036124b3575b151594909350915050565b60005b6000828152600180850160205260409091200154156107b8576000918252600180840160205260409092209091015490612513565b60005b6000828152600184016020526040902060020154156107b8576000918252600183016020526040909120600201549061254b565b60008181808080805b8a84108061259457508a155b80156125a75750898310806125a7575089155b80156125b257508515155b80156125c6575088861015806125c6575088155b1561267557600086815260018d016020526040902060050154959650869594506125f08686612c27565b6125fa9084613652565b92506126068585613652565b93508a8411801561261657508a15155b15612638576126258b85613611565b91506126318683612c27565b9050612664565b898311801561264657508915155b15612664576126558a84613611565b905061266186826129c1565b91505b61266e8c87611f6a565b9550612588565b8115612688576126858285613611565b93505b801561269b576126988184613611565b92505b959b949a509550955095509550565b6126b261324c565b60008381526001850160205260409020600581015483111561273c5760405162461bcd60e51b815260206004820152603860248201527f4f7264657253746174697374696373547265654c69623a20416d6f756e74207460448201527f6f2072656d6f766520697320696e73756666696369656e7400000000000000006064820152608401611ed7565b600381015465ffffffffffff61010090910481166000818152600684016020908152604091829020825160a08101845281548087168252600160301b8104871693820193909352600160601b9092049094169181019190915260018301546001600160a01b0316606082015260029092015460808301528491905b65ffffffffffff8116158015906127cd57508215155b1561291b5765ffffffffffff8082166000908152600686016020908152604091829020825160a08101845281548086168252600160301b8104861693820193909352600160601b9092049093169181019190915260018201546001600160a01b031660608201526002909101546080820181905290925083106128675760808201516128599084613611565b9250816020015190506127b7565b6040518060800160405280836000015165ffffffffffff16815260200183606001516001600160a01b031681526020018481526020016128a78986612c27565b905260409283015165ffffffffffff908116600090815260068701602090815290859020855160a08101875281548085168252600160301b8104851693820193909352600160601b9092049092169481019490945260018101546001600160a01b0316606085015260020154608084015294505b815165ffffffffffff16156129395761293988888460000151612c39565b6040850151156129b657604080860151600089815260018b016020908152838220895165ffffffffffff1683526006019052918220600201805491929091612982908490613611565b9091555050604080860151600089815260018b016020529182206005018054919290916129b0908490613611565b90915550505b505050509392505050565b6000610bc2612710610e37858561363b565b80546000908152600182016020526040902060020154158015612a0a57508054600090815260018083016020526040909120015415155b15612a6357805460009081526001808301602052604080832090910154825290206002015415612a555780546000908152600180830160205260409091200154612a55908290612e85565b612a63818260000154612f5c565b8054600090815260018201602052604090206003015460ff1615612a9f57805460009081526001820160205260409020600301805460ff191690555b50565b60008181808080805b8a841080612ab757508a155b8015612aca575089831080612aca575089155b8015612ad557508515155b8015612ae957508886111580612ae9575088155b1561267557600086815260018d01602052604090206005015495965086959450612b138686612c27565b612b1d9084613652565b9250612b298585613652565b93508a84118015612b3957508a15155b15612b5b57612b488b85613611565b9150612b548683612c27565b9050612b87565b8983118015612b6957508915155b15612b8757612b788a84613611565b9050612b8486826129c1565b91505b612b918c87611eb8565b9550612aab565b80546000908152600180830160205260409091200154158015612bcf57508054600090815260018201602052604090206002015415155b15612a63578054600090815260018083016020526040808320600201548352909120015415612c195780546000908152600182016020526040902060020154612c19908290612f5c565b612a63818260000154612e85565b6000610bc283610e376127108561363b565b612c44838383613030565b612ca55760405162461bcd60e51b815260206004820152602c60248201527f4f7264657253746174697374696373547265654c69623a204f7264657220646f60448201526b195cc81b9bdd08195e1a5cdd60a21b6064820152608401611ed7565b600082815260018085016020908152604080842065ffffffffffff808716865260068201808552838720845160a08101865281548085168252600160301b8104851682890152600160601b9004841681870152818801546001600160a01b0316606082015260029182015460808201526003850154610100900490931680895291909552929095209092015491939290915b8565ffffffffffff168365ffffffffffff1614612db05765ffffffffffff9283166000908152600686016020526040902054600160301b90049092169181612d7e816135f8565b65ffffffffffff85166000908152600688016020526040902060020154909350612da9915082613652565b9050612d37565b600385015465ffffffffffff8088166701000000000000009092041603612e0957612ddd8888600061304e565b6000878152600189016020526040902060030180546cffffffffffff0000000000000019169055612e47565b612e188888866020015161304e565b60208085015165ffffffffffff1660009081526006870190915260409020805465ffffffffffff60601b191690555b81856004016000828254612e5b9190613611565b9250508190555080856005016000828254612e769190613611565b90915550505050505050505050565b600081815260018084016020526040808320600281018054915482865292852090930154938590529183905590918015612ecd57600081815260018601602052604090208490555b6000838152600186016020526040902082905581612eed57828555612f39565b60008281526001808701602052604090912001548403612f225760008281526001808701602052604090912001839055612f39565b600082815260018601602052604090206002018390555b505060008181526001938401602052604080822090940183905591825291902055565b60008181526001808401602052604080832091820180549254838552918420600201549385905283905590918015612fa257600081815260018601602052604090208490555b6000838152600186016020526040902082905581612fc25782855561300e565b60008281526001860160205260409020600201548403612ff7576000828152600186016020526040902060020183905561300e565b600082815260018087016020526040909120018390555b5050600081815260019093016020526040808420600201839055918352912055565b600061303d848484613086565b80156114f557506114f584846131bb565b6000918252600190920160205260409020600301805465ffffffffffff9092166101000266ffffffffffff0019909216919091179055565b600082815260018085016020908152604080842065ffffffffffff808716808752600683018552838720845160a0810186528154808516808352600160301b8204861698830198909852600160601b900490931694830194909452948301546001600160a01b03166060820152600290920154608083015285939092146131135760009350505050610bc2565b5b604081015165ffffffffffff161561319c5760409081015165ffffffffffff808216600090815260068501602090815290849020845160a08101865281548085168252600160301b8104851693820193909352600160601b9092049092169381019390935260018101546001600160a01b031660608401526002015460808301529250613114565b5060030154610100900465ffffffffffff908116911614949350505050565b815460009082036131ce575060016106d3565b815b60008181526001850160205260409020541561324257600081815260018086016020526040808320548084529220908101548314801590613215575082816002015414155b1561322657600093505050506106d3565b8554820361323a57600193505050506106d3565b5090506131d0565b5060009392505050565b6040518060800160405280600065ffffffffffff16815260200160006001600160a01b0316815260200160008152602001600081525090565b803560ff81168114611e7157600080fd5b6000602082840312156132a857600080fd5b610bc282613285565b600081518084526020808501945080840160005b838110156132e1578151875295820195908201906001016132c5565b509495945050505050565b6040815260006132ff60408301856132b1565b905065ffffffffffff831660208301529392505050565b858152602081018590526040810184905261016081016133686060830185805165ffffffffffff1682526020808201516001600160a01b03169083015260408082015190830152606090810151910152565b825165ffffffffffff1660e083015260208301516001600160a01b0316610100830152604083015161012083015260608301516101408301529695505050505050565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156133d457600080fd5b823567ffffffffffffffff808211156133ec57600080fd5b818501915085601f83011261340057600080fd5b813581811115613412576134126133ab565b8060051b604051601f19603f83011681018181108582111715613437576134376133ab565b60405291825284820192508381018501918883111561345557600080fd5b938501935b828510156119965761346b85613285565b8452938501939285019261345a565b602081526000610bc260208301846132b1565b6000806000606084860312156134a257600080fd5b505081359360208301359350604090920135919050565b6000602082840312156134cb57600080fd5b5035919050565b6000806000606084860312156134e757600080fd5b6134f084613285565b95602085013595506040909401359392505050565b60808152600061351860808301876132b1565b828103602084015261352a81876132b1565b9050828103604084015261353e81866132b1565b91505082606083015295945050505050565b60008060006060848603121561356557600080fd5b61356e84613285565b925061357c60208501613285565b9150604084013590509250925092565b6000806040838503121561359f57600080fd5b6135a883613285565b946020939093013593505050565b634e487b7160e01b600052602160045260246000fd5b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b60006001820161360a5761360a6135e2565b5060010190565b818103818111156106d3576106d36135e2565b600081613633576136336135e2565b506000190190565b80820281158282048414176106d3576106d36135e2565b808201808211156106d3576106d36135e2565b600060ff821660ff810361367b5761367b6135e2565b60010192915050565b6000826136a157634e487b7160e01b600052601260045260246000fd5b500490565b60208082526035908201527f4f7264657253746174697374696373547265654c69623a205374617274696e676040820152742076616c75652063616e6e6f74206265207a65726f60581b60608201526080019056fea2646970667358221220e5d109928a791290228fd4d11a676fb3232a0c5857abdd3901fcaa2fcc08102a64736f6c63430008130033",
  "deployedBytecode": "0x73000000000000000000000000000000000000000030146080604052600436106101625760003560e01c80636aa65aaf116100cd578063a3b88aa011610086578063a3b88aa0146103aa578063ba1cbe98146103bd578063cd458662146103d0578063dded339b146103e3578063fbb759b4146103f6578063fffa87b81461042057600080fd5b80636aa65aaf146102df5780636c5d6df11461030157806380d5b6091461032157806382bdfed51461035457806389efbab1146103675780639beff3e31461038a57600080fd5b806350e187011161011f57806350e18701146102395780635575c79614610261578063576737171461029357806358e64897146102a65780635f7f8b45146102b95780636a5138d6146102cc57600080fd5b80631f98a42014610167578063261cc1b21461019157806329d6dd13146101c25780632bfa7c13146101e5578063381e93441461020657806338b0585214610219575b600080fd5b61017a610175366004613296565b610433565b6040516101889291906132ec565b60405180910390f35b81801561019d57600080fd5b506101b16101ac366004613296565b610454565b604051610188959493929190613316565b6101d56101d0366004613296565b61068a565b6040519015158152602001610188565b6101f86101f3366004613296565b6106bd565b604051908152602001610188565b6101d5610214366004613296565b6106d9565b61022c6102273660046133c1565b61070f565b604051610188919061347a565b61024c610247366004613296565b6107be565b60408051928352602083019190915201610188565b81801561026d57600080fd5b5061028161027c36600461348d565b61080c565b60405160ff9091168152602001610188565b61022c6102a13660046133c1565b6108a4565b6101f86102b4366004613296565b610944565b6101f86102c7366004613296565b610952565b6101d56102da366004613296565b610965565b8180156102eb57600080fd5b506102ff6102fa3660046134b9565b61099f565b005b81801561030d57600080fd5b506102ff61031c3660046134b9565b610a32565b61033461032f366004613296565b610aa1565b604080519485526020850193909352918301526060820152608001610188565b6101d5610362366004613296565b610ad9565b61037a6103753660046134d2565b610aee565b6040516101889493929190613505565b81801561039657600080fd5b506102ff6103a5366004613550565b610b1b565b6101f86103b836600461358c565b610baa565b61037a6103cb3660046134d2565b610bc9565b61022c6103de3660046133c1565b610be5565b6103346103f1366004613296565b610c80565b610409610404366004613296565b610ca7565b60405165ffffffffffff9091168152602001610188565b6101d561042e366004613296565b610ccb565b6060600061044b600161044585610d03565b90610d28565b91509150915091565b600080600061046161324c565b61046961324c565b600080600061047789610d03565b905061048281610e92565b929a509198509350915086156105ee57604080518082019091526000808252600160208301525b600281101561058b5760006104bc61324c565b6104e76040518060800160405280600081526020016000815260200160008152602001600081525090565b61050c8585600281106104fc576104fc6135cc565b602002015187908e6000806110af565b505060408201519093509091501561052857610528868e6111fa565b606082015115610575576000858560028110610546576105466135cc565b6020020151600181111561055c5761055c6135b6565b0361056d5760019250819850610575565b600092508199505b5050508080610583906135f8565b9150506104a9565b507fa9952c3d01896ca75bba3aede761be10089d8d4725c9fee6b99245515986ef606105b5611266565b54835460408051928352602083019190915281018b9052606081018690526080810185905260a081018a905260c00160405180910390a1505b60016105f8611266565b825460009081526005919091016020908152604091829020805460ff19169315159390931790925580516060810182528a8152918201859052810183905261063e611266565b6006016000836000015481526020019081526020016000206000820151816000015560208201518160010155604082015181600201559050508060010154955050505091939590929450565b6000610694611266565b60050160006106a284610d03565b54815260208101919091526040016000205460ff1692915050565b60006106d360016106cd84610d03565b90611294565b92915050565b6000610e106106e783610d03565b600101546106f59190613611565b42101580156106d357506107088261068a565b1592915050565b6060815167ffffffffffffffff81111561072b5761072b6133ab565b604051908082528060200260200182016040528015610754578160200160208202803683370190505b50905060005b82518110156107b857610785838281518110610778576107786135cc565b6020026020010151610d03565b6000015482828151811061079b5761079b6135cc565b6020908102919091010152806107b0816135f8565b91505061075a565b50919050565b6000806107e26107cc611266565b6003015460016107db86610d03565b919061133a565b91506108056107ef611266565b6003015460016107fe86610d03565b91906113bb565b9050915091565b6000610816611420565b905061082f84848461082785610d03565b9291906114a6565b610837611266565b60008681526005919091016020908152604091829020805460ff191693151593909317909255805160ff8416815291820186905281018490527f04ec0e7cdb609ffd421993d30756b50a4c420e88ce7f59bb3e29b5a8fe1fcf4a9060600160405180910390a19392505050565b6060815167ffffffffffffffff8111156108c0576108c06133ab565b6040519080825280602002602001820160405280156108e9578160200160208202803683370190505b50905060005b82518110156107b857610915610910848381518110610778576107786135cc565b6114fd565b828281518110610927576109276135cc565b60209081029190910101528061093c816135f8565b9150506108ef565b60006106d361091083610d03565b60006106d361096083610d03565b611518565b60006109708261068a565b8015610982575061098082610ad9565b155b80156106d3575061099282610d03565b6001015442101592915050565b61271081106109c157604051636d3872b560e11b815260040160405180910390fd5b60006109cb611266565b600201549050808214610a2e57816109e1611266565b600201557fad24e9bff76148b1b779fc330ea225198d2b44136c7a8e5fbec46c99c7775632610a0e611266565b546040805191825260208201849052810184905260600160405180910390a15b5050565b6127108110610a5457604051631ce2ca3b60e31b815260040160405180910390fd5b6000610a5e611266565b600301549050808214610a2e5781610a74611266565b600301557fee52d515b96986517a19b501c0a50b03f4edace46ba0484faaea7590969adcf6610a0e611266565b6000806000806000610ab286610d03565b9050610abc611266565b548154600183015460029093015491989097509195509350915050565b60006106d3610ae783610d03565b5442101590565b60608060606000610b0a8686610b038a610d03565b919061154d565b935093509350935093509350935093565b6000610b25611266565b60ff85166000908152600491909101602052604090209050610b48815442101590565b610b6557604051632e98f16560e11b815260040160405180910390fd5b6000610b6f611266565b60ff85166000908152600491909101602052604081209150610b92908290611294565b600003610ba357610ba381846111fa565b5050505050565b6000610bc2826001610bbb86610d03565b9190611866565b9392505050565b60608060606000610b0a8686610bde8a610d03565b91906119a2565b6060815167ffffffffffffffff811115610c0157610c016133ab565b604051908082528060200260200182016040528015610c2a578160200160208202803683370190505b50905060005b82518110156107b857610c51610960848381518110610778576107786135cc565b828281518110610c6357610c636135cc565b602090810291909101015280610c78816135f8565b915050610c30565b600080600080610c97610c9286610d03565b610e92565b93509350935093505b9193509193565b6000610cb282610d03565b60030154600160301b900465ffffffffffff1692915050565b600080610cd783610d03565b905080600201544210158015610bc25750610e108160010154610cfa9190613611565b42109392505050565b6000610d0d611266565b60ff9092166000908152600492909201602052506040902090565b60606000610d4c84600301600d9054906101000a90046001600160501b0316611cae565b600385015490925065ffffffffffff600160301b9091041642141580610d8c575081600081518110610d8057610d806135cc565b60200260200101516000145b80610d945750825b8015610dab57506003840154600160601b900460ff165b15610e7557600060018351610dc09190613611565b90505b8015610e1c5782610dd5600183613611565b81518110610de557610de56135cc565b6020026020010151838281518110610dff57610dff6135cc565b602090810291909101015280610e1481613624565b915050610dc3565b50610e3d84600501546127108660040154610e37919061363b565b90611dbe565b82600081518110610e5057610e506135cc565b6020908102919091010152506003830154600160301b900465ffffffffffff16610e8b565b506003830154600160b81b900465ffffffffffff165b9250929050565b80546000908152600b8201602052604081208190819081908190610eb590611e2f565b86546000908152600c88016020526040812091925090610ed490611e76565b87546000908152600b8901602090815260408083208684526001019091528120600501549192509088546000908152600c8a01602090815260408083208684526001019091528120600501549192509089546000908152600c8b0160209081526040808320600b8e019092529091209192509085851180610f53575084155b80610f5c575085155b15610f7a576000806000809950995099509950505050505050610ca0565b858511158015610f8a5750600085115b8015610f965750600086115b156110a25785985084975082841115610fef578599508287610fb89190613652565b9650610fc48385613611565b9350610fd08286611eb8565b60008181526001840160205260409020600501549095505b9250610f7a565b8284101561103c5784995083876110069190613652565b96506110128484613611565b925061101e8187611f6a565b60008181526001830160205260409020600501549096509350610f7a565b61104b6002610e378789613652565b99506110578488613652565b96506110638187611f6a565b955061106f8286611eb8565b60008781526001830160205260409020600501549095506000868152600184016020526040902060050154909450610fe8565b5050505050509193509193565b6110da6040518060800160405280600081526020016000815260200160008152602001600081525090565b6110e261324c565b6000806110ed61324c565b6001896001811115611101576111016135b6565b0361114d5789546000908152600b8b0160205260409020611124818a8a8a612013565b60408b01929092529189526020890192909252945091506111458154151590565b9250506111a9565b6000896001811115611161576111616135b6565b036111a95789546000908152600c8b0160205260409020611184818a8a8a61225d565b60408b01929092529189526020890192909252945091506111a58154151590565b9250505b6040518060800160405280826000015165ffffffffffff16815260200182602001516001600160a01b0316815260200182604001518152602001826060015181525093505095509550955095915050565b60039190910180546fffffffffffffffffffffffffffffffff60681b191661ffff909216600160681b0265ffffffffffff60b81b191691909117600160b81b4265ffffffffffff16908102919091176bffffffffffff0000000000001916600160301b91909102179055565b6000806106d360017ffc2836757f9146445fc75bc3c897a210ec004e4ee60fc8627ef5cbf2842b3d0a613611565b60038201546000906112b590600160681b90046001600160501b0316611cae565b6000815181106112c7576112c76135cc565b60200260200101519050428360030160069054906101000a900465ffffffffffff1665ffffffffffff161415806112fc575080155b806113045750815b801561131b57506003830154600160601b900460ff165b156106d357610bc283600501546127108560040154610e37919061363b565b60008061134985600385611866565b905061137261271061135c86600261363b565b61136890612710613652565b610e37908461363b565b9150612710821180611382575080155b156113915761271091506113b3565b61139d6102bc82613652565b8210156113b3576113b06102bc82613652565b91505b509392505050565b6000806113ca85600585611866565b90506113dc6127106113688682613611565b91508115806113e9575080155b806113f5575060c88111155b1561140357600191506113b3565b61140e60c883613652565b8110156113b3576113b060c882613611565b600060ff61142c611266565b6001015460ff160361145c576001611442611266565b600101805460ff191660ff92909216919091179055611492565b611464611266565b600101805460ff1690600061147883613665565b91906101000a81548160ff021916908360ff160217905550505b61149a611266565b6001015460ff16919050565b8284556001840182905560028401819055600060048501819055600585018190556003850180546601000000000000600160e81b03191690556114eb610e1084613611565b42106114f5575060015b949350505050565b80546000908152600b8201602052604081206106d390611e2f565b80546000908152600c820160205260408120819061153590611e76565b905080156115435780610bc2565b6127109392505050565b606080606060008467ffffffffffffffff81111561156d5761156d6133ab565b604051908082528060200260200182016040528015611596578160200160208202803683370190505b5093508467ffffffffffffffff8111156115b2576115b26133ab565b6040519080825280602002602001820160405280156115db578160200160208202803683370190505b5092508467ffffffffffffffff8111156115f7576115f76133ab565b604051908082528060200260200182016040528015611620578160200160208202803683370190505b50915060008660000361164f5787546000908152600c89016020526040902061164890611e76565b90506116b1565b87546000908152600c890160205260408120819061166d908a6124ab565b91509150811561167f578892506116ae565b8881111561168f578092506116ae565b89546000908152600c8b01602052604090206116ab9082611eb8565b92505b50505b80856000815181106116c5576116c56135cc565b60209081029190910181019190915288546000908152600c8a0182526040808220848352600101909252206005015484600081518110611707576117076135cc565b60209081029190910181019190915288546000908152600c8a0182526040808220848352600101909252206004015483600081518110611749576117496135cc565b602090810291909101015260015b85518110156118365781156118365788546000908152600c8a01602052604090206117829083611eb8565b915081868281518110611797576117976135cc565b60209081029190910181019190915289546000908152600c8b018252604080822085835260010190925220600501548582815181106117d8576117d86135cc565b60209081029190910181019190915289546000908152600c8b01825260408082208583526001019092522060040154848281518110611819576118196135cc565b60209081029190910101528061182e816135f8565b915050611757565b50801561185c5787546000908152600c8901602052604090206118599082611eb8565b91505b5093509350935093565b60008061188985600301600d9054906101000a90046001600160501b0316611cae565b8051600387015491925090600090819065ffffffffffff600160301b90910416421415806118b45750855b80156118cb57506003880154600160601b900460ff165b156118fe576118ea88600501546127108a60040154610e37919061363b565b915060019050866118fa81613624565b9750505b60005b8781101561197c5783811015806119315750848181518110611925576119256135cc565b60200260200101516000145b61197c57848181518110611947576119476135cc565b60200260200101518361195a9190613652565b925081611966816135f8565b9250508080611974906135f8565b915050611901565b506000811161198c576000611996565b6119968282611dbe565b98975050505050505050565b606080606060008467ffffffffffffffff8111156119c2576119c26133ab565b6040519080825280602002602001820160405280156119eb578160200160208202803683370190505b5093508467ffffffffffffffff811115611a0757611a076133ab565b604051908082528060200260200182016040528015611a30578160200160208202803683370190505b5092508467ffffffffffffffff811115611a4c57611a4c6133ab565b604051908082528060200260200182016040528015611a75578160200160208202803683370190505b509150600086600003611aa45787546000908152600b890160205260409020611a9d90611e2f565b9050611b06565b87546000908152600b8901602052604081208190611ac2908a6124ab565b915091508115611ad457889250611b03565b88811015611ae457809250611b03565b89546000908152600b8b0160205260409020611b009082611f6a565b92505b50505b8085600081518110611b1a57611b1a6135cc565b60209081029190910181019190915288546000908152600b8a0182526040808220848352600101909252206005015484600081518110611b5c57611b5c6135cc565b60209081029190910181019190915288546000908152600b8a0182526040808220848352600101909252206004015483600081518110611b9e57611b9e6135cc565b602090810291909101015260015b8551811015611c8b578115611c8b5788546000908152600b8a0160205260409020611bd79083611f6a565b915081868281518110611bec57611bec6135cc565b60209081029190910181019190915289546000908152600b8b01825260408082208583526001019092522060050154858281518110611c2d57611c2d6135cc565b60209081029190910181019190915289546000908152600b8b01825260408082208583526001019092522060040154848281518110611c6e57611c6e6135cc565b602090810291909101015280611c83816135f8565b915050611bac565b50801561185c5787546000908152600b8901602052604090206118599082611f6a565b60408051600580825260c082019092526060916020820160a0803683370190505090508161ffff1681600081518110611ce957611ce96135cc565b6020026020010181815250506010826001600160501b0316901c61ffff1681600181518110611d1a57611d1a6135cc565b6020026020010181815250506020826001600160501b0316901c61ffff1681600281518110611d4b57611d4b6135cc565b6020026020010181815250506030826001600160501b0316901c61ffff1681600381518110611d7c57611d7c6135cc565b6020026020010181815250506040826001600160501b0316901c61ffff1681600481518110611dad57611dad6135cc565b602002602001018181525050919050565b6000808211611dcc57600080fd5b6005611dd88385613684565b611de390600a61363b565b83611def86600a61363b565b611df99190613684565b611e039190613611565b1015611e1a57611e138284613684565b90506106d3565b611e248284613684565b611e13906001613652565b805480611e3e57506000919050565b5b600081815260018301602052604090206002015415611e71576000908152600182016020526040902060020154611e3f565b919050565b805480611e8557506000919050565b5b600081815260018084016020526040909120015415611e71576000908152600180830160205260409091200154611e86565b600081611ee05760405162461bcd60e51b8152600401611ed7906136a6565b60405180910390fd5b600082815260018401602052604090206002015415611f18576000828152600184016020526040902060020154611e13908490612510565b5060008181526001830160205260409020545b8015801590611f4c5750600081815260018401602052604090206002015482145b156106d3576000818152600184016020526040902054909150611f2b565b600081611f895760405162461bcd60e51b8152600401611ed7906136a6565b600082815260018085016020526040909120015415611fc1576000828152600180850160205260409091200154611e13908490612548565b5060008181526001830160205260409020545b8015801590611ff55750600081815260018085016020526040909120015482145b156106d3576000818152600184016020526040902054909150611fd4565b60008060008061202161324c565b600061202c8a611e2f565b905060008060008984101580612040575089155b6120875760405162461bcd60e51b8152602060048201526018602482015277496e73756666696369656e74206c696d69742076616c756560401b6044820152606401611ed7565b6120948d8d8d8d8861257f565b959e50919c509a5091965094509250905060006120b1838a613652565b905080156121a65782156120dd578994506120d68e866120d18688613611565b6126aa565b9550612102565b8115612102578994506120ff8e866120f588866129c1565b6120d19088613611565b95505b600085815260018f016020526040812060028101919091555485156121a4575b80156121a4578581101561218e57808f6001016000888152602001908152602001600020600001541461218a57808f600101600088815260200190815260200160002060000181905550858f6001016000838152602001908152602001600020600201819055505b8095505b600090815260018f016020526040902054612122565b505b808d11156121bb576121b8818e613611565b96505b60006121c68f611e76565b90508a811480156121ef57508e6001016000828152602001908152602001600020600501546000145b156121fd5760008f55612243565b8e548b108061221657508e548b1480156122165750818a145b1561224357858f6000018190555060008f6001016000888152602001908152602001600020600001819055505b61224c8f6129d3565b505050505050945094509450945094565b60008060008061226b61324c565b60006122768a611e76565b90506000806000898411158061228a575089155b6122d15760405162461bcd60e51b8152602060048201526018602482015277496e73756666696369656e74206c696d69742076616c756560401b6044820152606401611ed7565b6122de8d8d8d8d88612aa2565b959e50919c509a5091965094509250905060006122fb838a613652565b905080156124055782156123225789945061231b8e866120d18688613611565b955061233d565b811561233d5789945061233a8e866120f588866129c1565b95505b60008e60010160008781526020019081526020016000206001018190555060008e600101600087815260200190815260200160002060000154905060008614612403575b801561240357858111156123ed57808f600101600088815260200190815260200160002060000154146123e957808f600101600088815260200190815260200160002060000181905550858f6001016000838152602001908152602001600020600101819055505b8095505b600090815260018f016020526040902054612381565b505b808d111561241a57612417818e613611565b96505b60006124258f611e2f565b90508a8114801561244e57508e6001016000828152602001908152602001600020600501546000145b1561245c5760008f556124a2565b8e548b118061247557508e548b1480156124755750818a145b156124a257858f6000018190555060008f6001016000888152602001908152602001600020600001819055505b61224c8f612b98565b815460009081905b801561250557808410156124dd5760008181526001808701602052604090912001549091506124fd565b808411156124fd5760008181526001860160205260409020600201549091505b8381036124b3575b151594909350915050565b60005b6000828152600180850160205260409091200154156107b8576000918252600180840160205260409092209091015490612513565b60005b6000828152600184016020526040902060020154156107b8576000918252600183016020526040909120600201549061254b565b60008181808080805b8a84108061259457508a155b80156125a75750898310806125a7575089155b80156125b257508515155b80156125c6575088861015806125c6575088155b1561267557600086815260018d016020526040902060050154959650869594506125f08686612c27565b6125fa9084613652565b92506126068585613652565b93508a8411801561261657508a15155b15612638576126258b85613611565b91506126318683612c27565b9050612664565b898311801561264657508915155b15612664576126558a84613611565b905061266186826129c1565b91505b61266e8c87611f6a565b9550612588565b8115612688576126858285613611565b93505b801561269b576126988184613611565b92505b959b949a509550955095509550565b6126b261324c565b60008381526001850160205260409020600581015483111561273c5760405162461bcd60e51b815260206004820152603860248201527f4f7264657253746174697374696373547265654c69623a20416d6f756e74207460448201527f6f2072656d6f766520697320696e73756666696369656e7400000000000000006064820152608401611ed7565b600381015465ffffffffffff61010090910481166000818152600684016020908152604091829020825160a08101845281548087168252600160301b8104871693820193909352600160601b9092049094169181019190915260018301546001600160a01b0316606082015260029092015460808301528491905b65ffffffffffff8116158015906127cd57508215155b1561291b5765ffffffffffff8082166000908152600686016020908152604091829020825160a08101845281548086168252600160301b8104861693820193909352600160601b9092049093169181019190915260018201546001600160a01b031660608201526002909101546080820181905290925083106128675760808201516128599084613611565b9250816020015190506127b7565b6040518060800160405280836000015165ffffffffffff16815260200183606001516001600160a01b031681526020018481526020016128a78986612c27565b905260409283015165ffffffffffff908116600090815260068701602090815290859020855160a08101875281548085168252600160301b8104851693820193909352600160601b9092049092169481019490945260018101546001600160a01b0316606085015260020154608084015294505b815165ffffffffffff16156129395761293988888460000151612c39565b6040850151156129b657604080860151600089815260018b016020908152838220895165ffffffffffff1683526006019052918220600201805491929091612982908490613611565b9091555050604080860151600089815260018b016020529182206005018054919290916129b0908490613611565b90915550505b505050509392505050565b6000610bc2612710610e37858561363b565b80546000908152600182016020526040902060020154158015612a0a57508054600090815260018083016020526040909120015415155b15612a6357805460009081526001808301602052604080832090910154825290206002015415612a555780546000908152600180830160205260409091200154612a55908290612e85565b612a63818260000154612f5c565b8054600090815260018201602052604090206003015460ff1615612a9f57805460009081526001820160205260409020600301805460ff191690555b50565b60008181808080805b8a841080612ab757508a155b8015612aca575089831080612aca575089155b8015612ad557508515155b8015612ae957508886111580612ae9575088155b1561267557600086815260018d01602052604090206005015495965086959450612b138686612c27565b612b1d9084613652565b9250612b298585613652565b93508a84118015612b3957508a15155b15612b5b57612b488b85613611565b9150612b548683612c27565b9050612b87565b8983118015612b6957508915155b15612b8757612b788a84613611565b9050612b8486826129c1565b91505b612b918c87611eb8565b9550612aab565b80546000908152600180830160205260409091200154158015612bcf57508054600090815260018201602052604090206002015415155b15612a63578054600090815260018083016020526040808320600201548352909120015415612c195780546000908152600182016020526040902060020154612c19908290612f5c565b612a63818260000154612e85565b6000610bc283610e376127108561363b565b612c44838383613030565b612ca55760405162461bcd60e51b815260206004820152602c60248201527f4f7264657253746174697374696373547265654c69623a204f7264657220646f60448201526b195cc81b9bdd08195e1a5cdd60a21b6064820152608401611ed7565b600082815260018085016020908152604080842065ffffffffffff808716865260068201808552838720845160a08101865281548085168252600160301b8104851682890152600160601b9004841681870152818801546001600160a01b0316606082015260029182015460808201526003850154610100900490931680895291909552929095209092015491939290915b8565ffffffffffff168365ffffffffffff1614612db05765ffffffffffff9283166000908152600686016020526040902054600160301b90049092169181612d7e816135f8565b65ffffffffffff85166000908152600688016020526040902060020154909350612da9915082613652565b9050612d37565b600385015465ffffffffffff8088166701000000000000009092041603612e0957612ddd8888600061304e565b6000878152600189016020526040902060030180546cffffffffffff0000000000000019169055612e47565b612e188888866020015161304e565b60208085015165ffffffffffff1660009081526006870190915260409020805465ffffffffffff60601b191690555b81856004016000828254612e5b9190613611565b9250508190555080856005016000828254612e769190613611565b90915550505050505050505050565b600081815260018084016020526040808320600281018054915482865292852090930154938590529183905590918015612ecd57600081815260018601602052604090208490555b6000838152600186016020526040902082905581612eed57828555612f39565b60008281526001808701602052604090912001548403612f225760008281526001808701602052604090912001839055612f39565b600082815260018601602052604090206002018390555b505060008181526001938401602052604080822090940183905591825291902055565b60008181526001808401602052604080832091820180549254838552918420600201549385905283905590918015612fa257600081815260018601602052604090208490555b6000838152600186016020526040902082905581612fc25782855561300e565b60008281526001860160205260409020600201548403612ff7576000828152600186016020526040902060020183905561300e565b600082815260018087016020526040909120018390555b5050600081815260019093016020526040808420600201839055918352912055565b600061303d848484613086565b80156114f557506114f584846131bb565b6000918252600190920160205260409020600301805465ffffffffffff9092166101000266ffffffffffff0019909216919091179055565b600082815260018085016020908152604080842065ffffffffffff808716808752600683018552838720845160a0810186528154808516808352600160301b8204861698830198909852600160601b900490931694830194909452948301546001600160a01b03166060820152600290920154608083015285939092146131135760009350505050610bc2565b5b604081015165ffffffffffff161561319c5760409081015165ffffffffffff808216600090815260068501602090815290849020845160a08101865281548085168252600160301b8104851693820193909352600160601b9092049092169381019390935260018101546001600160a01b031660608401526002015460808301529250613114565b5060030154610100900465ffffffffffff908116911614949350505050565b815460009082036131ce575060016106d3565b815b60008181526001850160205260409020541561324257600081815260018086016020526040808320548084529220908101548314801590613215575082816002015414155b1561322657600093505050506106d3565b8554820361323a57600193505050506106d3565b5090506131d0565b5060009392505050565b6040518060800160405280600065ffffffffffff16815260200160006001600160a01b0316815260200160008152602001600081525090565b803560ff81168114611e7157600080fd5b6000602082840312156132a857600080fd5b610bc282613285565b600081518084526020808501945080840160005b838110156132e1578151875295820195908201906001016132c5565b509495945050505050565b6040815260006132ff60408301856132b1565b905065ffffffffffff831660208301529392505050565b858152602081018590526040810184905261016081016133686060830185805165ffffffffffff1682526020808201516001600160a01b03169083015260408082015190830152606090810151910152565b825165ffffffffffff1660e083015260208301516001600160a01b0316610100830152604083015161012083015260608301516101408301529695505050505050565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156133d457600080fd5b823567ffffffffffffffff808211156133ec57600080fd5b818501915085601f83011261340057600080fd5b813581811115613412576134126133ab565b8060051b604051601f19603f83011681018181108582111715613437576134376133ab565b60405291825284820192508381018501918883111561345557600080fd5b938501935b828510156119965761346b85613285565b8452938501939285019261345a565b602081526000610bc260208301846132b1565b6000806000606084860312156134a257600080fd5b505081359360208301359350604090920135919050565b6000602082840312156134cb57600080fd5b5035919050565b6000806000606084860312156134e757600080fd5b6134f084613285565b95602085013595506040909401359392505050565b60808152600061351860808301876132b1565b828103602084015261352a81876132b1565b9050828103604084015261353e81866132b1565b91505082606083015295945050505050565b60008060006060848603121561356557600080fd5b61356e84613285565b925061357c60208501613285565b9150604084013590509250925092565b6000806040838503121561359f57600080fd5b6135a883613285565b946020939093013593505050565b634e487b7160e01b600052602160045260246000fd5b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b60006001820161360a5761360a6135e2565b5060010190565b818103818111156106d3576106d36135e2565b600081613633576136336135e2565b506000190190565b80820281158282048414176106d3576106d36135e2565b808201808211156106d3576106d36135e2565b600060ff821660ff810361367b5761367b6135e2565b60010192915050565b6000826136a157634e487b7160e01b600052601260045260246000fd5b500490565b60208082526035908201527f4f7264657253746174697374696373547265654c69623a205374617274696e676040820152742076616c75652063616e6e6f74206265207a65726f60581b60608201526080019056fea2646970667358221220e5d109928a791290228fd4d11a676fb3232a0c5857abdd3901fcaa2fcc08102a64736f6c63430008130033",
  "devdoc": {
    "kind": "dev",
    "methods": {},
    "version": 1
  },
  "userdoc": {
    "kind": "user",
    "methods": {},
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}